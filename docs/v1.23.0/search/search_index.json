{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to opsworks_ruby \u00b6 opsworks_ruby is a set of chef recipes to ease the deployment to AWS OpsWorks service. It was created, when Amazon introduced Chef 12 to OpsWorks stack without support for any chef recipes. The main goal of this project is to mimic Chef 11 OpsWorks stack as close as possible. The code is open source, and available on github . The main documentation for the site is organized into a couple sections: User Documentation Cookbook Documentation About opsworks_ruby User Documentation \u00b6 Getting Started Super Quick Start Quick Start Full configuration Troubleshooting Deployment fails with errors regarding application code SSL not working in legacy browsers Some applications on my Layer deploys, some of them not Environment variables fail to update on clean restart Cookbook Documentation \u00b6 Supported Technologies Requirements Cookbooks Platform Attributes Stack attributes Cross-application attributes Application attributes Logrotate Attributes Recipes About opsworks_ruby \u00b6 Contributing Pull Requests Running Tests Author and Contributors Author Contributors Changelog License","title":"Home"},{"location":"#welcome-to-opsworks_ruby","text":"opsworks_ruby is a set of chef recipes to ease the deployment to AWS OpsWorks service. It was created, when Amazon introduced Chef 12 to OpsWorks stack without support for any chef recipes. The main goal of this project is to mimic Chef 11 OpsWorks stack as close as possible. The code is open source, and available on github . The main documentation for the site is organized into a couple sections: User Documentation Cookbook Documentation About opsworks_ruby","title":"Welcome to opsworks_ruby"},{"location":"#user-documentation","text":"Getting Started Super Quick Start Quick Start Full configuration Troubleshooting Deployment fails with errors regarding application code SSL not working in legacy browsers Some applications on my Layer deploys, some of them not Environment variables fail to update on clean restart","title":"User Documentation"},{"location":"#cookbook-documentation","text":"Supported Technologies Requirements Cookbooks Platform Attributes Stack attributes Cross-application attributes Application attributes Logrotate Attributes Recipes","title":"Cookbook Documentation"},{"location":"#about-opsworks_ruby","text":"Contributing Pull Requests Running Tests Author and Contributors Author Contributors Changelog License","title":"About opsworks_ruby"},{"location":"attributes/","text":"Attributes \u00b6 Attributes format follows the guidelines of old Chef 11.x based OpsWorks stack. So all of them, need to be placed under node['deploy'][<application_shortname>] . Attributes (and whole logic of this cookbook) are divided to six sections. Following convention is used: app == node['deploy'][<application_shortname>] so for example app['framework']['adapter'] actually means node['deploy'][<application_shortname>]['framework']['adapter'] . Stack attributes \u00b6 These attributes are used on Stack/Layer level globally to configure the opsworks_ruby cookbook itself. They should'nt be used under node['deploy'][<application_shortname>] (notice lack of the app[] convention). node['applications'] An array of application shortnames which should be deployed to given layer. If set, only applications witch deploy flag set (on OpsWorks side) included in this list will be deployed. If not set, all deploy application will be supported. This parameter mostly matters during the setup phase, since all application in given stack are deployed to the given layer. Using this paramter you can narrow the list to application which you actually intend to use. Note Important thing is, that when you try to do a manual deploy from OpsWorks of an application, not included in this list - it will be skipped, as this list takes precedence over anything else. node['ruby-provider'] Note Important please note, that NO compatibility checks for distro/repositories are performed. It's user responsibility to ensure, that given ruby version from given provider can be installed on given platform. For example fullstaq only works on Ubuntu 18.04 platform, installing it on 16.04 will fail. Type: string Default: ruby-ng Supported values: ruby-ng , fullstaq Sets the rubies packages provider. It configures proper apt repository and package namespaces. node['ruby-version'] Note Important please note, that some versions may be available on one system, and not on the other (for example ruby-ng gets freshest versions of ruby way earlier than Amazon Linux). Type: string Default: 3.0 Sets the Ruby version used through the system. For debian-based distributions, a ruby-ng cookbook is used (check ruby-ng cookbook documentation ). For Amazon Linux, packages provided by distribution (i.e. ruby23 , ruby23-devel etc.). node['ruby-variant'] Note Important This option works only when node['ruby-provider'] is set to fullstaq . Type: string Supported values: none, jemalloc , malloctrim Sets ruby variant for given version. node['use-nodejs'] Type: boolean Default: false If enabled, a nodejs and yarn will be installed on a machine, to provide support for webpack and assets precompilation. node['chef-version'] Note Important plase note, that true is hazardous, because it allows uncontrolled upgrade to a potentially major version, i.e. breaking change could occur. Type: integer or boolean Default: false If enabled current chef on OpsWorks will be updated to provided version (if integer provided) or the the latest version (if true ). Patches \u00b6 Chef 12 (which AWS opsworks ruby is based on) is EOL. It uses old libraries and dependencies, which will start be more and more problematic. \"Patches\" section of config is an attempt to workaround this - as long, as it's possible. Note All of those options are set to true by default and it's strongly discouraged to disable them. However if you have any problems with anything those patches touch, disabling them, is a first step to troubleshoot them. node['patches']['chef12_ssl_fix'] Type: boolean Default: true Chef 12 OpenSSL provide very old certificates list - most of them are expired now. This fix, force chef to use more recent list (and valid) list. See Issue #268 for more information. Cross-application attributes \u00b6 These attributes can only be set at the server level; they cannot vary from application to application. webserver \u00b6 node['defaults']['webserver']['remove_default_sites'] Type: array Default: %w[default default.conf 000-default 000-default.conf default-ssl default-ssl.conf] Note : Only applies to Apache2 webserver A list of \"default site\" filenames that should be removed (if they exist) from /etc/{httpd,apache2}/sites-enabled in order to disable any \"default site\" provided by the OS-provided Apache2 package. Set this to nil or an empty array ( [] ) if you want the default site to be enabled. Application attributes \u00b6 global \u00b6 Global parameters apply to the whole application, and can be used by any section (framework, appserver etc.). app['global']['environment'] Type: string Default: production Sets the \"deploy environment\" for all the app-related (for example RAILS_ENV in Rails) actions in the project (server, worker, etc.) app['global']['deploy_dir'] Type: string Default: /srv/www/app_name Determines where the application will be deployed. Note that if you override this setting, you'll typically want to include the short_name in the setting. In other words, this setting doesn't override the /srv/www base directory defafult; it overrides the application-specific /srv/www/app_name default. app['global']['symlinks'] Note Important Notice: Any values for this parameter will be merged to the defaults Type: key-value Default: { \"system\": \"public/system\", \"assets\": \"public/assets\", \"cache\": \"tmp/cache\", \"pids\": \"tmp/pids\", \"log\": \"log\" } List of symlinks created to the shared directory. The format is {\"shared_path\": \"release_path\"} . For example {\"system\", \"public/system\"} means: Link /src/www/app_name/current/public/system to /src/www/app_name/shared/system . app['global']['create_dirs_before_symlink'] Note Important Notice: Any values for this parameter will be appended to the defaults Type: array Default: [\"tmp\", \"public\", \"config\", \"../../shared/cache\", \"../../shared/assets\"] List of directories to be created before symlinking. Paths are relative to release_path . For example tmp becomes /srv/www/app_name/current/tmp . app['global']['purge_before_symlink'] Note Important Notice: Any values for this parameter will be appended to the defaults Type: array Default: [\"log\", \"tmp/cache\", \"tmp/pids\", \"public/system\", \"public/assets\"] List of directories to be wiped out before symlinking. Paths are relative to release_path . For example tmp becomes /srv/www/app_name/current/tmp . app['global']['rollback_on_error'] Type: boolean Default: true When set to true, any failed deploy will be removed from releases directory. app['global']['logrotate_rotate'] Note Important Notice: The parameter is in days Type: integer Default: 30 How many days of logfiles are kept. See Logrotate Attributes for more information on logrotate attribute precedence. app['global']['logrotate_frequency'] Type: string Default: daily Supported values: daily , weekly , monthly , size X How often logrotate runs for the given log(s), either time-based or when the log(s) reach a certain size. See Logrotate Attributes for more information on logrotate attribute precedence. app['global']['logrotate_options'] Type: Array Default: %w[missingok compress delaycompress notifempty copytruncate sharedscripts] All of the unqualified options (i.e., without arguments) that should be enabled for the specified logrotate configuration. See Logrotate Attributes for more information on logrotate attribute precedence. app['global']['logrotate_X'] Type: Varies Any attribute value Y for logrotate_X will cause the logrotate_app resource X to be called with argument Y. For example setting logrotate_cookbook to 'my_cookbook' will result in the logrotate_app resource being invoked with the resource value cookbook 'my_cookbook' . See Logrotate Attributes for more information on logrotate attribute precedence. app['global']['deploy_revision'] Type: boolean Default: false When set to true, deployments will use the deploy_revision provider. The name of a release sub-directory will use a revision identifier rather than a timestamp. See the deploy_revision documentation for more information. database \u00b6 Those parameters will be passed without any alteration to the database.yml file. Keep in mind, that if you have RDS connected to your OpsWorks application, you don\u2019t need to use them. The chef will do all the job, and determine them for you. Note Important Rails 6 introduced multiple database support. This configuration option supports that, by adding extra key to database which is grouping the fields, for example: app['database']['primary']['adapter'] . For backward compatibility old format is also supported. app['database']['adapter'] Supported values: aurora , aurora-postgresql , mariadb , mysql , postgis , postgresql , sqlite3 , null Default: sqlite3 ActiveRecord adapter which will be used for database connection. null means that no database will be configured, and is currently only tested with the rails framework. app['database']['username'] Username used to authenticate to the DB app['database']['password'] Password used to authenticate to the DB app['database']['host'] Database host app['database']['database'] Database name app['database'][<any other>] Any other key-value pair provided here, will be passed directly to the database.yml source \u00b6 Those parameters can also be determined from OpsWorks application, and usually you don't need to provide them here. Currently only git is supported. app['source']['adapter'] Supported values: git , http , s3 Default: git Source used by the cookbook to fetch the application codebase. app['source']['url'] Source code URL (repository URL for SCMs). git \u00b6 app['source']['remove_scm_files'] Supported values: true , false Default: true If set to true, all SCM leftovers (like .git ) will be removed. app['source']['revision'] Branch name/SHA1 of commit which should be use as a base of the deployment. app['source']['ssh_key'] A private SSH deploy key (the key itself, not the file name), used when fetching repositories via SSH. app['source']['ssh_wrapper'] A wrapper script, which will be used by git when fetching repository via SSH. Essentially, a value of GIT_SSH environment variable. This cookbook provides one of those scripts for you, so you shouldn't alter this variable unless you know what you're doing. app['source']['generated_ssh_wrapper'] Default: /tmp/ssh-git-wrapper.sh If the cookbook generates an SSH wrapper for you, this is where it will generate it. For users whose /tmp partitions are mounted noexec (a good security practice to prevent code injection exploits), this attribute allows you to override that location to a partition where execution of the generated shell script is allowed. app['source']['enabled_submodules'] If set to true , any submodules included in the repository, will also be fetched. s3 \u00b6 This source expects a packed project in one of the following formats: bzip2 , compress , gzip , tar , xz or zip . If you are using ubuntu, 7zip is also supported. app['source']['user'] AWS_ACCESS_KEY_ID with read access to the bucket. app['source']['password'] AWS_SECRET_ACCESS_KEY for given AWS_ACCESS_KEY_ID . http \u00b6 This source expects a packed project in one of the following formats: bzip2 , compress , gzip , tar , xz or zip . If you are using ubuntu, 7zip is also supported. app['source']['user'] If file is hidden behind HTTP BASIC AUTH, this field should contain username. app['source']['password'] If file is hidden behind HTTP BASIC AUTH, this field should contain password. framework \u00b6 Pre-optimalization for specific frameworks (like migrations, cache etc.). Currently hanami.rb and Rails are supported. app['framework']['adapter'] Supported values: null , hanami , padrino , rails Default: rails Ruby framework used in project. app['framework']['migrate'] Supported values: true , false Default: true If set to true , migrations will be launch during deployment. app['framework']['migration_command'] A command which will be invoked to perform migration. This cookbook comes with predefined migration commands, well suited for the task, and usually you don't have to change this parameter. app['framework']['assets_precompile'] Supported values: true , false Default: true app['framework']['assets_precompilation_command'] A command which will be invoked to precompile assets. app['framework']['logrotate_name'] Type: string Default: Depends on adapter-specific behaviors The name of the logrotate_app resource, and generated configuration file, for the specified app framework logrotate configuration. Unlike other logrotate attributes, this attribute can only be set or overridden at a the app framework level; there are no app-wide or global settings beyond those provided by the framework library app['framework']['logrotate_log_paths'] Type: Array Default: Depends on adapter-specific behaviors Which log file(s) should be backed up via logrotate. If this parameter evaluates to an empty array, no logs will be backed up for the specified app framework. Unlike other logrotate attributes, this attribute can only be set or overridden at a the app framework level; there are no app-wide or global settings beyond those provided by the framework library. padrino \u00b6 For Padrino, slight adjustments needs to be made. Since there are many database adapters supported, instead of creating configuration for each one, the DATABASE_URL environmental variable is provided. You need to parse it in your config/database.rb file and properly pass to the configuration options. For example, for ActiveRecord: database_url = ENV['DATABASE_URL'] && ActiveRecord::ConnectionAdapters::ConnectionSpecification::ConnectionUrlResolver.new(ENV['DATABASE_URL']).to_hash ActiveRecord::Base.configurations[:production] = database_url || { :adapter => 'sqlite3', :database => Padrino.root('db', 'dummy_app_production.db') } rails \u00b6 app['framework']['envs_in_console'] Warning This is highly unstable feature. If you experience any troubles with deployments, and have this feature enabled, consider disabling it as a first step in your debugging process. Supported values: true , false Default: false If set to true, rails console will be invoked with all application-level environment variables set. appserver \u00b6 Configuration parameters for the ruby application server. Currently Puma , Thin , Unicorn and Passenger are supported. app['appserver']['adapter'] Default: puma Supported values: puma , thin , unicorn , passenger , null Server on the application side, which will receive requests from webserver in front. null means no appserver enabled. app['appserver']['application_yml'] Supported values: true , false Default: false Creates a config/application.yml file with all pre-configured environment variables. Useful for gems like figaro app['appserver']['dot_env'] Supported values: true , false Default: false Creates a .env file with all pre-configured environment variables. Useful for gems like dotenv app['appserver']['preload_app'] Supported values: true , false Default: true Enabling this preloads an application before forking worker processes. app['appserver']['timeout'] Default: 50 Sets the timeout of worker processes to seconds. app['appserver']['worker_processes']| Default: 4 Sets the current number of worker processes. Each worker process will serve exactly one client at a time. app['appserver']['passenger_version'] Default: None Which Debian APT package version should be installed from the PPA repo provided by Passenger. Currently this defaults to the latest version provided by the Passenger APT PPA. Set this to a non-nil value to lock your Passenger installation at a specific version. app['appserver']['port'] Default: None Bind the appserver to a port on 0.0.0.0. This is useful for serving the application directly from the appserver without a web server middleware or separating the web server into its own container or server. This can also be used for running multiple applications on a server when using apache as your webserver. app['appserver']['monit_template_cookbook'] Default opsworks_ruby The name of the cookbook from which the appserver monit template(s) will be drawn. unicorn \u00b6 app['appserver']['backlog'] Default: 1024 app['appserver']['delay'] Default: 0.5 app['appserver']['tcp_nodelay'] Supported values: true , false Default: true app['appserver']['tcp_nopush'] Supported values: true , false Default: false app['appserver']['tries'] Default: 5 puma \u00b6 app['appserver']['log_requests'] Supported values: true , false Default: false app['appserver']['thread_max'] Default: 16 app['appserver']['thread_min'] Default: 0 app['appserver']['on_restart'] Code to run before doing a restart. This code should close log files, database connections, etc. app['appserver']['before_fork'] Code to run immediately before the master starts workers. app['appserver']['on_worker_boot'] Code to run in a worker before it starts serving requests. This is called everytime a worker is to be started. app['appserver']['on_worker_shutdown'] Code to run in a worker right before it exits. This is called everytime a worker is to about to shutdown. app['appserver']['on_worker_fork'] Code to run in the master right before a worker is started. The worker's index is passed as an argument. This is called everytime a worker is to be started. app['appserver']['after_worker_fork'] Code to run in the master after a worker has been started. The worker's index is passed as an argument. This is called everytime a worker is to be started. thin \u00b6 app['appserver']['max_connections'] Default: 1024 app['appserver']['max_persistent_connections'] Default: 512 app['appserver']['timeout'] Default: 60 app['appserver']['worker_processes'] Default: 4 passenger \u00b6 app['appserver']['max_pool_size'] Type: Integer Default: Passenger-provided default (based on server capacity) Sets the PassengerMaxPoolSize parameter app['appserver']['min_instances'] Type: Integer Default: Passenger-provided default (based on server capacity) Sets the PassengerMinInstances parameter app['appserver']['mount_point'] Default: / Which URL path should be handled by Passenger. This option allows you to configure your application to handle only a subset of requests made to your web server. Useful for certain hybrid static/dynamic web sites. app['appserver']['pool_idle_time'] Type: Integer Default: 300 Sets the PoolIdleTime parameter app['appserver']['max_request_queue_size'] Type: Integer Default: 100 Sets the MaxRequestQueueSize parameter app['appserver']['error_document'] Type: Hash Default: off Sets the { \"status\": \"file\" } parameter e.g. { \"500\": \"500.html\", \"503\": \"503.html\" } app['appserver']['passenger_max_preloader_idle_time'] Type: Integer Default: 300 Sets the PassengerMaxPreloaderIdleTime parameter webserver \u00b6 Webserver configuration. Proxy passing to application is handled out-of-the-box. Currently Apache2 and nginx is supported. app['webserver']['adapter'] Default: nginx Supported values: apache2 , nginx , null Webserver in front of the instance. It runs on port 80 by default (see app['webserver']['port'] ), and receives all requests from the Load Balancer/Internet. null means no webserver enabled. app['webserver']['dhparams'] If you wish to use custom generated DH primes, instead of common ones (which is a very good practice), put the contents (not file name) of the dhparams.pem file into this attribute. Read more here. app['webserver']['keepalive_timeout'] Default : 15 The number of seconds webserver will wait for a subsequent request before closing the connection. app['webserver']['ssl_for_legacy_browsers'] Supported values: true , false Default: false By default webserver is configured to follow strict SSL security standards, covered in this article . However, old browsers (like IE < 9 or Android < 2.2) wouldn't work with this configuration very well. If your application needs a support for those browsers, set this parameter to true . app['webserver']['port'] Default 80 The port on which the webserver should listen for HTTP requests. app['webserver']['ssl_port'] Default 443 The port on which the webserver should listen for HTTPs requests, if SSL requests are enabled. Note that SSL itself is controlled by the app['enable_ssl'] setting in Opsworks. app['webserver']['force_ssl'] Supported values: true , false Default false When this parameter is set to true all requests passed to http will be redirected to https, with 301 status code. This works only when SSL in OpsWorks panel is enabled, otherwise it's ommited. app['webserver']['site_config_template'] Default appserver.apache2.conf.erb or appserver.nginx.conf.erb The name of the cookbook template that should be used to generate per-app configuration stanzas (known as a \"site\" in apache and nginx configuration parlance). Useful in situations where inserting an extra_config text section doesn't provide enough flexibility to customize your per-app webserver configuration stanza to your liking. Note that when you use a custom site configuration template, you can also choose to define extra_config as any data structure (e.g., Hash or even nested Hash) to be interpreted by your custom template. This provides somewhat unlimited flexibility to configure the webserver app configuration however you see fit. app['webserver']['site_config_template_cookbook'] Default opsworks_ruby The name of the cookbook in which the site configuration template can be found. If you override app['webserver']['site_config_template'] to use a site configuration template from your own cookbook, you'll need to override this setting as well to ensure that the opsworks_ruby cookbook looks for the specified template in your cookbook. app['webserver']['logrotate_name'] Type: string Default: Depends on adapter-specific behaviors The name of the logrotate_app resource, and generated configuration file, for the specified app webserver logrotate configuration. Unlike other logrotate attributes, this attribute can only be set or overridden at a the app webserver level; there are no app-wide or global settings beyond those provided by the webserver library app['webserver']['logrotate_log_paths'] Type: Array Default: Depends on adapter-specific behaviors Which log file(s) should be backed up via logrotate. If this parameter evaluates to an empty array, no logs will be backed up for the specified app webserver. Unlike other logrotate attributes, this attribute can only be set or overridden at a the app webserver level; there are no app-wide or global settings beyond those provided by the webserver library apache \u00b6 app['webserver']['extra_config'] Raw Apache2 configuration, which will be inserted into <Virtualhost *:80> (or other port, if specified) section of the application. app['webserver']['extra_config_ssl'] Raw Apache2 configuration, which will be inserted into <Virtualhost *:443> (or other port, if specified for SSL) section of the application. If set to true , the extra_config will be copied. app['webserver']['limit_request_body'] Default : 1048576 app['webserver']['log_level'] Default : info app['webserver']['log_dir'] Default : /var/log/apache2 (debian) or /var/log/httpd (rhel) A place to store application-related Apache2 logs. app['webserver']['proxy_timeout'] Default : 60 nginx \u00b6 app['webserver']['build_type'] Supported values: default or source Default: default The way the nginx cookbooks handles nginx installation. Check out the corresponding docs for more details. Never use node['nginx']['install_method'] , as it will be always overwritten by this attribute. app['webserver']['client_body_timeout'] Default: 12 app['webserver']['client_header_timeout'] Default: 12 app['webserver']['client_max_body_size'] Default: 10m app['webserver']['extra_config'] Raw nginx configuration, which will be inserted into server section of the application for HTTP port. app['webserver']['extra_config_ssl'] Raw nginx configuration, which will be inserted into server section of the application for HTTPS port. If set to true , the extra_config will be copied. app['webserver']['log_dir'] Default : /var/log/nginx A place to store application-related nginx logs. app['webserver']['proxy_read_timeout'] Default : 60 app['webserver']['proxy_send_timeout'] Default : 60 app['webserver']['send_timeout'] Default : 10 app['webserver']['enable_upgrade_method'] Supported values: true , false Default : false When set to true, enable Websocket's upgrade method such as Rails actionCable. Since this driver is basically a wrapper for nginx cookbook , you can also configure node['nginx'] attributes as well (notice that node['deploy'][<application_shortname>] logic doesn't apply here.) worker \u00b6 Worker configuration. Currently sidekiq, delayed_job, resque, shoryuken, good_job. app['worker']['adapter'] Default: null Supported values: sidekiq , delayed_job , resque , shoryuken , good_job , and null . If worker is needed, here it can be set up and configured. null means no worker installed. app['worker']['monit_template_cookbook'] Default opsworks_ruby The name of the cookbook from which the worker monit template(s) will be drawn. app['worker']['dot_env'] Supported values: true , false Default: false Creates a .env file with all pre-configured environment variables. Useful for gems like dotenv sidekiq \u00b6 app['worker']['config'] Configuration parameters which will be directly passed to the worker. For example, for sidekiq they will be serialized to sidekiq.yml config file . delayed_job \u00b6 app['worker']['queues'] Array of queues which should be processed by delayed_job resque \u00b6 app['worker']['workers'] Default: 2 Number of resque workers app['worker']['queues'] Default: * Array of queues which should be processed by resque shoryuken \u00b6 app['worker']['config'] Configuration parameters which will be directly passed to the worker. For example, for shoryuken they will be serialized to the relevant shoryuken.yml config file . app['worker']['process_count'] Default: 1 Number of shoryuken runner daemons to start. Shoryuken is multithreaded, so defaults to 1. app['worker']['require'] Path to require, relative to the currently deployed application directory. app['worker']['require_rails'] Supported values: true , false Default : false Emits -R to require the rails environment on boot. app['worker']['syslog'] Supported values: true , false Default : false Configures piping shoryuken runner log output to syslog via logger good_job \u00b6 app['worker']['queues'] Array of queues which should be processed by good_job Logrotate Attributes \u00b6 Logrotate behaviors occur across multiple drivers, for example webserver and framework. For this reason, the evaluation order for attribute-driven behaviors is a bit more complex for logrotate than for other options that are either entirely global (for example, global.environment ) or entirely isolated to a single type of driver ( webserver.keepalive_timeout ). The evaluation rules for logrotate setting X are as follows, from highest priority to lowest priority: app[driver_type]['logrotate_X'] app['global']['logrotate_X'] node['defaults'][driver_type]['logrotate_X'] node['defaults']['global']['logrotate_X']","title":"Attributes"},{"location":"attributes/#attributes","text":"Attributes format follows the guidelines of old Chef 11.x based OpsWorks stack. So all of them, need to be placed under node['deploy'][<application_shortname>] . Attributes (and whole logic of this cookbook) are divided to six sections. Following convention is used: app == node['deploy'][<application_shortname>] so for example app['framework']['adapter'] actually means node['deploy'][<application_shortname>]['framework']['adapter'] .","title":"Attributes"},{"location":"attributes/#stack-attributes","text":"These attributes are used on Stack/Layer level globally to configure the opsworks_ruby cookbook itself. They should'nt be used under node['deploy'][<application_shortname>] (notice lack of the app[] convention). node['applications'] An array of application shortnames which should be deployed to given layer. If set, only applications witch deploy flag set (on OpsWorks side) included in this list will be deployed. If not set, all deploy application will be supported. This parameter mostly matters during the setup phase, since all application in given stack are deployed to the given layer. Using this paramter you can narrow the list to application which you actually intend to use. Note Important thing is, that when you try to do a manual deploy from OpsWorks of an application, not included in this list - it will be skipped, as this list takes precedence over anything else. node['ruby-provider'] Note Important please note, that NO compatibility checks for distro/repositories are performed. It's user responsibility to ensure, that given ruby version from given provider can be installed on given platform. For example fullstaq only works on Ubuntu 18.04 platform, installing it on 16.04 will fail. Type: string Default: ruby-ng Supported values: ruby-ng , fullstaq Sets the rubies packages provider. It configures proper apt repository and package namespaces. node['ruby-version'] Note Important please note, that some versions may be available on one system, and not on the other (for example ruby-ng gets freshest versions of ruby way earlier than Amazon Linux). Type: string Default: 3.0 Sets the Ruby version used through the system. For debian-based distributions, a ruby-ng cookbook is used (check ruby-ng cookbook documentation ). For Amazon Linux, packages provided by distribution (i.e. ruby23 , ruby23-devel etc.). node['ruby-variant'] Note Important This option works only when node['ruby-provider'] is set to fullstaq . Type: string Supported values: none, jemalloc , malloctrim Sets ruby variant for given version. node['use-nodejs'] Type: boolean Default: false If enabled, a nodejs and yarn will be installed on a machine, to provide support for webpack and assets precompilation. node['chef-version'] Note Important plase note, that true is hazardous, because it allows uncontrolled upgrade to a potentially major version, i.e. breaking change could occur. Type: integer or boolean Default: false If enabled current chef on OpsWorks will be updated to provided version (if integer provided) or the the latest version (if true ).","title":"Stack attributes"},{"location":"attributes/#patches","text":"Chef 12 (which AWS opsworks ruby is based on) is EOL. It uses old libraries and dependencies, which will start be more and more problematic. \"Patches\" section of config is an attempt to workaround this - as long, as it's possible. Note All of those options are set to true by default and it's strongly discouraged to disable them. However if you have any problems with anything those patches touch, disabling them, is a first step to troubleshoot them. node['patches']['chef12_ssl_fix'] Type: boolean Default: true Chef 12 OpenSSL provide very old certificates list - most of them are expired now. This fix, force chef to use more recent list (and valid) list. See Issue #268 for more information.","title":"Patches"},{"location":"attributes/#cross-application-attributes","text":"These attributes can only be set at the server level; they cannot vary from application to application.","title":"Cross-application attributes"},{"location":"attributes/#webserver","text":"node['defaults']['webserver']['remove_default_sites'] Type: array Default: %w[default default.conf 000-default 000-default.conf default-ssl default-ssl.conf] Note : Only applies to Apache2 webserver A list of \"default site\" filenames that should be removed (if they exist) from /etc/{httpd,apache2}/sites-enabled in order to disable any \"default site\" provided by the OS-provided Apache2 package. Set this to nil or an empty array ( [] ) if you want the default site to be enabled.","title":"webserver"},{"location":"attributes/#application-attributes","text":"","title":"Application attributes"},{"location":"attributes/#global","text":"Global parameters apply to the whole application, and can be used by any section (framework, appserver etc.). app['global']['environment'] Type: string Default: production Sets the \"deploy environment\" for all the app-related (for example RAILS_ENV in Rails) actions in the project (server, worker, etc.) app['global']['deploy_dir'] Type: string Default: /srv/www/app_name Determines where the application will be deployed. Note that if you override this setting, you'll typically want to include the short_name in the setting. In other words, this setting doesn't override the /srv/www base directory defafult; it overrides the application-specific /srv/www/app_name default. app['global']['symlinks'] Note Important Notice: Any values for this parameter will be merged to the defaults Type: key-value Default: { \"system\": \"public/system\", \"assets\": \"public/assets\", \"cache\": \"tmp/cache\", \"pids\": \"tmp/pids\", \"log\": \"log\" } List of symlinks created to the shared directory. The format is {\"shared_path\": \"release_path\"} . For example {\"system\", \"public/system\"} means: Link /src/www/app_name/current/public/system to /src/www/app_name/shared/system . app['global']['create_dirs_before_symlink'] Note Important Notice: Any values for this parameter will be appended to the defaults Type: array Default: [\"tmp\", \"public\", \"config\", \"../../shared/cache\", \"../../shared/assets\"] List of directories to be created before symlinking. Paths are relative to release_path . For example tmp becomes /srv/www/app_name/current/tmp . app['global']['purge_before_symlink'] Note Important Notice: Any values for this parameter will be appended to the defaults Type: array Default: [\"log\", \"tmp/cache\", \"tmp/pids\", \"public/system\", \"public/assets\"] List of directories to be wiped out before symlinking. Paths are relative to release_path . For example tmp becomes /srv/www/app_name/current/tmp . app['global']['rollback_on_error'] Type: boolean Default: true When set to true, any failed deploy will be removed from releases directory. app['global']['logrotate_rotate'] Note Important Notice: The parameter is in days Type: integer Default: 30 How many days of logfiles are kept. See Logrotate Attributes for more information on logrotate attribute precedence. app['global']['logrotate_frequency'] Type: string Default: daily Supported values: daily , weekly , monthly , size X How often logrotate runs for the given log(s), either time-based or when the log(s) reach a certain size. See Logrotate Attributes for more information on logrotate attribute precedence. app['global']['logrotate_options'] Type: Array Default: %w[missingok compress delaycompress notifempty copytruncate sharedscripts] All of the unqualified options (i.e., without arguments) that should be enabled for the specified logrotate configuration. See Logrotate Attributes for more information on logrotate attribute precedence. app['global']['logrotate_X'] Type: Varies Any attribute value Y for logrotate_X will cause the logrotate_app resource X to be called with argument Y. For example setting logrotate_cookbook to 'my_cookbook' will result in the logrotate_app resource being invoked with the resource value cookbook 'my_cookbook' . See Logrotate Attributes for more information on logrotate attribute precedence. app['global']['deploy_revision'] Type: boolean Default: false When set to true, deployments will use the deploy_revision provider. The name of a release sub-directory will use a revision identifier rather than a timestamp. See the deploy_revision documentation for more information.","title":"global"},{"location":"attributes/#database","text":"Those parameters will be passed without any alteration to the database.yml file. Keep in mind, that if you have RDS connected to your OpsWorks application, you don\u2019t need to use them. The chef will do all the job, and determine them for you. Note Important Rails 6 introduced multiple database support. This configuration option supports that, by adding extra key to database which is grouping the fields, for example: app['database']['primary']['adapter'] . For backward compatibility old format is also supported. app['database']['adapter'] Supported values: aurora , aurora-postgresql , mariadb , mysql , postgis , postgresql , sqlite3 , null Default: sqlite3 ActiveRecord adapter which will be used for database connection. null means that no database will be configured, and is currently only tested with the rails framework. app['database']['username'] Username used to authenticate to the DB app['database']['password'] Password used to authenticate to the DB app['database']['host'] Database host app['database']['database'] Database name app['database'][<any other>] Any other key-value pair provided here, will be passed directly to the database.yml","title":"database"},{"location":"attributes/#source","text":"Those parameters can also be determined from OpsWorks application, and usually you don't need to provide them here. Currently only git is supported. app['source']['adapter'] Supported values: git , http , s3 Default: git Source used by the cookbook to fetch the application codebase. app['source']['url'] Source code URL (repository URL for SCMs).","title":"source"},{"location":"attributes/#git","text":"app['source']['remove_scm_files'] Supported values: true , false Default: true If set to true, all SCM leftovers (like .git ) will be removed. app['source']['revision'] Branch name/SHA1 of commit which should be use as a base of the deployment. app['source']['ssh_key'] A private SSH deploy key (the key itself, not the file name), used when fetching repositories via SSH. app['source']['ssh_wrapper'] A wrapper script, which will be used by git when fetching repository via SSH. Essentially, a value of GIT_SSH environment variable. This cookbook provides one of those scripts for you, so you shouldn't alter this variable unless you know what you're doing. app['source']['generated_ssh_wrapper'] Default: /tmp/ssh-git-wrapper.sh If the cookbook generates an SSH wrapper for you, this is where it will generate it. For users whose /tmp partitions are mounted noexec (a good security practice to prevent code injection exploits), this attribute allows you to override that location to a partition where execution of the generated shell script is allowed. app['source']['enabled_submodules'] If set to true , any submodules included in the repository, will also be fetched.","title":"git"},{"location":"attributes/#s3","text":"This source expects a packed project in one of the following formats: bzip2 , compress , gzip , tar , xz or zip . If you are using ubuntu, 7zip is also supported. app['source']['user'] AWS_ACCESS_KEY_ID with read access to the bucket. app['source']['password'] AWS_SECRET_ACCESS_KEY for given AWS_ACCESS_KEY_ID .","title":"s3"},{"location":"attributes/#http","text":"This source expects a packed project in one of the following formats: bzip2 , compress , gzip , tar , xz or zip . If you are using ubuntu, 7zip is also supported. app['source']['user'] If file is hidden behind HTTP BASIC AUTH, this field should contain username. app['source']['password'] If file is hidden behind HTTP BASIC AUTH, this field should contain password.","title":"http"},{"location":"attributes/#framework","text":"Pre-optimalization for specific frameworks (like migrations, cache etc.). Currently hanami.rb and Rails are supported. app['framework']['adapter'] Supported values: null , hanami , padrino , rails Default: rails Ruby framework used in project. app['framework']['migrate'] Supported values: true , false Default: true If set to true , migrations will be launch during deployment. app['framework']['migration_command'] A command which will be invoked to perform migration. This cookbook comes with predefined migration commands, well suited for the task, and usually you don't have to change this parameter. app['framework']['assets_precompile'] Supported values: true , false Default: true app['framework']['assets_precompilation_command'] A command which will be invoked to precompile assets. app['framework']['logrotate_name'] Type: string Default: Depends on adapter-specific behaviors The name of the logrotate_app resource, and generated configuration file, for the specified app framework logrotate configuration. Unlike other logrotate attributes, this attribute can only be set or overridden at a the app framework level; there are no app-wide or global settings beyond those provided by the framework library app['framework']['logrotate_log_paths'] Type: Array Default: Depends on adapter-specific behaviors Which log file(s) should be backed up via logrotate. If this parameter evaluates to an empty array, no logs will be backed up for the specified app framework. Unlike other logrotate attributes, this attribute can only be set or overridden at a the app framework level; there are no app-wide or global settings beyond those provided by the framework library.","title":"framework"},{"location":"attributes/#padrino","text":"For Padrino, slight adjustments needs to be made. Since there are many database adapters supported, instead of creating configuration for each one, the DATABASE_URL environmental variable is provided. You need to parse it in your config/database.rb file and properly pass to the configuration options. For example, for ActiveRecord: database_url = ENV['DATABASE_URL'] && ActiveRecord::ConnectionAdapters::ConnectionSpecification::ConnectionUrlResolver.new(ENV['DATABASE_URL']).to_hash ActiveRecord::Base.configurations[:production] = database_url || { :adapter => 'sqlite3', :database => Padrino.root('db', 'dummy_app_production.db') }","title":"padrino"},{"location":"attributes/#rails","text":"app['framework']['envs_in_console'] Warning This is highly unstable feature. If you experience any troubles with deployments, and have this feature enabled, consider disabling it as a first step in your debugging process. Supported values: true , false Default: false If set to true, rails console will be invoked with all application-level environment variables set.","title":"rails"},{"location":"attributes/#appserver","text":"Configuration parameters for the ruby application server. Currently Puma , Thin , Unicorn and Passenger are supported. app['appserver']['adapter'] Default: puma Supported values: puma , thin , unicorn , passenger , null Server on the application side, which will receive requests from webserver in front. null means no appserver enabled. app['appserver']['application_yml'] Supported values: true , false Default: false Creates a config/application.yml file with all pre-configured environment variables. Useful for gems like figaro app['appserver']['dot_env'] Supported values: true , false Default: false Creates a .env file with all pre-configured environment variables. Useful for gems like dotenv app['appserver']['preload_app'] Supported values: true , false Default: true Enabling this preloads an application before forking worker processes. app['appserver']['timeout'] Default: 50 Sets the timeout of worker processes to seconds. app['appserver']['worker_processes']| Default: 4 Sets the current number of worker processes. Each worker process will serve exactly one client at a time. app['appserver']['passenger_version'] Default: None Which Debian APT package version should be installed from the PPA repo provided by Passenger. Currently this defaults to the latest version provided by the Passenger APT PPA. Set this to a non-nil value to lock your Passenger installation at a specific version. app['appserver']['port'] Default: None Bind the appserver to a port on 0.0.0.0. This is useful for serving the application directly from the appserver without a web server middleware or separating the web server into its own container or server. This can also be used for running multiple applications on a server when using apache as your webserver. app['appserver']['monit_template_cookbook'] Default opsworks_ruby The name of the cookbook from which the appserver monit template(s) will be drawn.","title":"appserver"},{"location":"attributes/#unicorn","text":"app['appserver']['backlog'] Default: 1024 app['appserver']['delay'] Default: 0.5 app['appserver']['tcp_nodelay'] Supported values: true , false Default: true app['appserver']['tcp_nopush'] Supported values: true , false Default: false app['appserver']['tries'] Default: 5","title":"unicorn"},{"location":"attributes/#puma","text":"app['appserver']['log_requests'] Supported values: true , false Default: false app['appserver']['thread_max'] Default: 16 app['appserver']['thread_min'] Default: 0 app['appserver']['on_restart'] Code to run before doing a restart. This code should close log files, database connections, etc. app['appserver']['before_fork'] Code to run immediately before the master starts workers. app['appserver']['on_worker_boot'] Code to run in a worker before it starts serving requests. This is called everytime a worker is to be started. app['appserver']['on_worker_shutdown'] Code to run in a worker right before it exits. This is called everytime a worker is to about to shutdown. app['appserver']['on_worker_fork'] Code to run in the master right before a worker is started. The worker's index is passed as an argument. This is called everytime a worker is to be started. app['appserver']['after_worker_fork'] Code to run in the master after a worker has been started. The worker's index is passed as an argument. This is called everytime a worker is to be started.","title":"puma"},{"location":"attributes/#thin","text":"app['appserver']['max_connections'] Default: 1024 app['appserver']['max_persistent_connections'] Default: 512 app['appserver']['timeout'] Default: 60 app['appserver']['worker_processes'] Default: 4","title":"thin"},{"location":"attributes/#passenger","text":"app['appserver']['max_pool_size'] Type: Integer Default: Passenger-provided default (based on server capacity) Sets the PassengerMaxPoolSize parameter app['appserver']['min_instances'] Type: Integer Default: Passenger-provided default (based on server capacity) Sets the PassengerMinInstances parameter app['appserver']['mount_point'] Default: / Which URL path should be handled by Passenger. This option allows you to configure your application to handle only a subset of requests made to your web server. Useful for certain hybrid static/dynamic web sites. app['appserver']['pool_idle_time'] Type: Integer Default: 300 Sets the PoolIdleTime parameter app['appserver']['max_request_queue_size'] Type: Integer Default: 100 Sets the MaxRequestQueueSize parameter app['appserver']['error_document'] Type: Hash Default: off Sets the { \"status\": \"file\" } parameter e.g. { \"500\": \"500.html\", \"503\": \"503.html\" } app['appserver']['passenger_max_preloader_idle_time'] Type: Integer Default: 300 Sets the PassengerMaxPreloaderIdleTime parameter","title":"passenger"},{"location":"attributes/#webserver_1","text":"Webserver configuration. Proxy passing to application is handled out-of-the-box. Currently Apache2 and nginx is supported. app['webserver']['adapter'] Default: nginx Supported values: apache2 , nginx , null Webserver in front of the instance. It runs on port 80 by default (see app['webserver']['port'] ), and receives all requests from the Load Balancer/Internet. null means no webserver enabled. app['webserver']['dhparams'] If you wish to use custom generated DH primes, instead of common ones (which is a very good practice), put the contents (not file name) of the dhparams.pem file into this attribute. Read more here. app['webserver']['keepalive_timeout'] Default : 15 The number of seconds webserver will wait for a subsequent request before closing the connection. app['webserver']['ssl_for_legacy_browsers'] Supported values: true , false Default: false By default webserver is configured to follow strict SSL security standards, covered in this article . However, old browsers (like IE < 9 or Android < 2.2) wouldn't work with this configuration very well. If your application needs a support for those browsers, set this parameter to true . app['webserver']['port'] Default 80 The port on which the webserver should listen for HTTP requests. app['webserver']['ssl_port'] Default 443 The port on which the webserver should listen for HTTPs requests, if SSL requests are enabled. Note that SSL itself is controlled by the app['enable_ssl'] setting in Opsworks. app['webserver']['force_ssl'] Supported values: true , false Default false When this parameter is set to true all requests passed to http will be redirected to https, with 301 status code. This works only when SSL in OpsWorks panel is enabled, otherwise it's ommited. app['webserver']['site_config_template'] Default appserver.apache2.conf.erb or appserver.nginx.conf.erb The name of the cookbook template that should be used to generate per-app configuration stanzas (known as a \"site\" in apache and nginx configuration parlance). Useful in situations where inserting an extra_config text section doesn't provide enough flexibility to customize your per-app webserver configuration stanza to your liking. Note that when you use a custom site configuration template, you can also choose to define extra_config as any data structure (e.g., Hash or even nested Hash) to be interpreted by your custom template. This provides somewhat unlimited flexibility to configure the webserver app configuration however you see fit. app['webserver']['site_config_template_cookbook'] Default opsworks_ruby The name of the cookbook in which the site configuration template can be found. If you override app['webserver']['site_config_template'] to use a site configuration template from your own cookbook, you'll need to override this setting as well to ensure that the opsworks_ruby cookbook looks for the specified template in your cookbook. app['webserver']['logrotate_name'] Type: string Default: Depends on adapter-specific behaviors The name of the logrotate_app resource, and generated configuration file, for the specified app webserver logrotate configuration. Unlike other logrotate attributes, this attribute can only be set or overridden at a the app webserver level; there are no app-wide or global settings beyond those provided by the webserver library app['webserver']['logrotate_log_paths'] Type: Array Default: Depends on adapter-specific behaviors Which log file(s) should be backed up via logrotate. If this parameter evaluates to an empty array, no logs will be backed up for the specified app webserver. Unlike other logrotate attributes, this attribute can only be set or overridden at a the app webserver level; there are no app-wide or global settings beyond those provided by the webserver library","title":"webserver"},{"location":"attributes/#apache","text":"app['webserver']['extra_config'] Raw Apache2 configuration, which will be inserted into <Virtualhost *:80> (or other port, if specified) section of the application. app['webserver']['extra_config_ssl'] Raw Apache2 configuration, which will be inserted into <Virtualhost *:443> (or other port, if specified for SSL) section of the application. If set to true , the extra_config will be copied. app['webserver']['limit_request_body'] Default : 1048576 app['webserver']['log_level'] Default : info app['webserver']['log_dir'] Default : /var/log/apache2 (debian) or /var/log/httpd (rhel) A place to store application-related Apache2 logs. app['webserver']['proxy_timeout'] Default : 60","title":"apache"},{"location":"attributes/#nginx","text":"app['webserver']['build_type'] Supported values: default or source Default: default The way the nginx cookbooks handles nginx installation. Check out the corresponding docs for more details. Never use node['nginx']['install_method'] , as it will be always overwritten by this attribute. app['webserver']['client_body_timeout'] Default: 12 app['webserver']['client_header_timeout'] Default: 12 app['webserver']['client_max_body_size'] Default: 10m app['webserver']['extra_config'] Raw nginx configuration, which will be inserted into server section of the application for HTTP port. app['webserver']['extra_config_ssl'] Raw nginx configuration, which will be inserted into server section of the application for HTTPS port. If set to true , the extra_config will be copied. app['webserver']['log_dir'] Default : /var/log/nginx A place to store application-related nginx logs. app['webserver']['proxy_read_timeout'] Default : 60 app['webserver']['proxy_send_timeout'] Default : 60 app['webserver']['send_timeout'] Default : 10 app['webserver']['enable_upgrade_method'] Supported values: true , false Default : false When set to true, enable Websocket's upgrade method such as Rails actionCable. Since this driver is basically a wrapper for nginx cookbook , you can also configure node['nginx'] attributes as well (notice that node['deploy'][<application_shortname>] logic doesn't apply here.)","title":"nginx"},{"location":"attributes/#worker","text":"Worker configuration. Currently sidekiq, delayed_job, resque, shoryuken, good_job. app['worker']['adapter'] Default: null Supported values: sidekiq , delayed_job , resque , shoryuken , good_job , and null . If worker is needed, here it can be set up and configured. null means no worker installed. app['worker']['monit_template_cookbook'] Default opsworks_ruby The name of the cookbook from which the worker monit template(s) will be drawn. app['worker']['dot_env'] Supported values: true , false Default: false Creates a .env file with all pre-configured environment variables. Useful for gems like dotenv","title":"worker"},{"location":"attributes/#sidekiq","text":"app['worker']['config'] Configuration parameters which will be directly passed to the worker. For example, for sidekiq they will be serialized to sidekiq.yml config file .","title":"sidekiq"},{"location":"attributes/#delayed_job","text":"app['worker']['queues'] Array of queues which should be processed by delayed_job","title":"delayed_job"},{"location":"attributes/#resque","text":"app['worker']['workers'] Default: 2 Number of resque workers app['worker']['queues'] Default: * Array of queues which should be processed by resque","title":"resque"},{"location":"attributes/#shoryuken","text":"app['worker']['config'] Configuration parameters which will be directly passed to the worker. For example, for shoryuken they will be serialized to the relevant shoryuken.yml config file . app['worker']['process_count'] Default: 1 Number of shoryuken runner daemons to start. Shoryuken is multithreaded, so defaults to 1. app['worker']['require'] Path to require, relative to the currently deployed application directory. app['worker']['require_rails'] Supported values: true , false Default : false Emits -R to require the rails environment on boot. app['worker']['syslog'] Supported values: true , false Default : false Configures piping shoryuken runner log output to syslog via logger","title":"shoryuken"},{"location":"attributes/#good_job","text":"app['worker']['queues'] Array of queues which should be processed by good_job","title":"good_job"},{"location":"attributes/#logrotate-attributes","text":"Logrotate behaviors occur across multiple drivers, for example webserver and framework. For this reason, the evaluation order for attribute-driven behaviors is a bit more complex for logrotate than for other options that are either entirely global (for example, global.environment ) or entirely isolated to a single type of driver ( webserver.keepalive_timeout ). The evaluation rules for logrotate setting X are as follows, from highest priority to lowest priority: app[driver_type]['logrotate_X'] app['global']['logrotate_X'] node['defaults'][driver_type]['logrotate_X'] node['defaults']['global']['logrotate_X']","title":"Logrotate Attributes"},{"location":"changelog/","text":"1.23.0 (2022-06-30) \u00b6 Features \u00b6 worker: worker option to use dot env ( #289 ) ( ba3d312 ) 1.22.0 (2022-02-09) \u00b6 Bug Fixes \u00b6 appserver: use pumactl start for restart if the puma.state file does not exists ( #276 ) ( c2c8713 ), closes #274 Features \u00b6 worker: add good_job support ( af98d67 ) 1.21.1 (2021-10-13) \u00b6 Bug Fixes \u00b6 modify the restart process for puma so that it can do a proper restart instead of killing and restarting the app ( #257 ) ( 035ffb9 ) 1.21.0 (2021-10-08) \u00b6 Bug Fixes \u00b6 patch broken SSL certificates list ( 4887cf5 ), closes #268 update rubies for ruby-nq and fullstack, set default ruby to 2.7 ( 09ba7e1 ), closes #266 BREAKING CHANGES \u00b6 By default new list of SSL certificates is used. It should not affect any of your current deployments, but if you start seeing SSL errors, the first thing you should check, is disabling node['patches']['chef12_ssl_fix'] option. See https://github.com/ajgon/opsworks_ruby/issues/268 for more information. 1.20.3 (2021-05-06) \u00b6 Features \u00b6 webserver: apache2 - configurable mod_status ( a82335d ), closes #259 1.20.2 (2021-02-07) \u00b6 Bug Fixes \u00b6 run monit reload only once, after configure hook ( 1b784d1 ), closes #251 1.20.1 (2020-12-12) \u00b6 Features \u00b6 webserver: add CORS for /packs endpoints ( ede019d ), closes #248 1.20.0 (2020-12-08) \u00b6 Bug Fixes \u00b6 setup: fix fullstaq key url ( #247 ) ( 62ced10 ) Features \u00b6 appserver: move appserver processes to foreground ( 37b9465 ), closes #244 deploy: use revision-based deploy provider ( #245 ) ( 27887e6 ) BREAKING CHANGES \u00b6 appserver: Theoretically everything should work out of the box, and you shouldn't notice any change on your environment. However if your appserver start behave oddly (or probably - won't start at all) - this may be the first reason for that. Check generated monit files, check if monit is running and also check the syslog (monit is configured to write all the appserver output there). 1.19.0 (2020-08-02) \u00b6 Features \u00b6 deploy: include deploy resource polyfill ( 4f6d6fd ), closes #242 1.18.1 (2020-05-13) \u00b6 Bug Fixes \u00b6 setup: link fullstaq ruby to /usr/local/bin ( 559c015 ), closes #237 1.18.0 (2020-02-29) \u00b6 Bug Fixes \u00b6 appserver: fix .env and application.yml symlinks creation ( 0580955 ), closes #232 Features \u00b6 appserver: Add new appserver config params for passenger ( #227 ) ( 0500521 ) setup: add support for fullstaq ruby repos ( 1489d01 ), closes #229 1.17.0 (2019-11-23) \u00b6 Bug Fixes \u00b6 replace symlink options instead of appending them ( b2650fb ), closes #224 Features \u00b6 database: add support for multiple databases per environment ( 0c7f89f ), closes #226 BREAKING CHANGES \u00b6 app['global']['create_dirs_before_symlink'] , app['global']['purge_before_symlink'] and app['global']['symlinks'] now overrides defaults instead of appending them. If you were relying on those options in your Custom JSON, you need to add missing defaults manually. For example given: { \"deploy\": { \"myapp\": { \"global\": { \"create_dirs_before_symlink\": [\"test/create\"], \"purge_before_symlink\": [\"test/purge\"], \"symlinks\": { \"test\": \"test/symlinks\" } } } } } you need to replace it to: { \"deploy\": { \"myapp\": { \"global\": { \"create_dirs_before_symlink\": [\"tmp\", \"public\", \"config\", \"../../shared/cache\", \"../../shared/assets\", \"test/create\"], \"purge_before_symlink\": [\"log\", \"tmp/cache\", \"tmp/pids\", \"public/system\", \"public/assets\", \"test/purge\"], \"symlinks\": { \"system\": \"public/system\", \"assets\": \"public/assets\", \"cache\": \"tmp/cache\", \"pids\": \"tmp/pids\", \"log\": \"log\", \"test\": \"test/symlinks\" } } } } } 1.16.0 (2019-09-11) \u00b6 Bug Fixes \u00b6 webserver: remove default nginx config from conf.d ( #220 ) ( 23929e3 ) keep the last nginx cookbook version compatible with chef 12 ( b5b13d0 ), closes #222 Features \u00b6 setup: add chef version configuration option ( ffe2b42 ) 1.15.0 (2019-07-09) \u00b6 Bug Fixes \u00b6 apache: fix apache serving assets rather than proxying to app server ( #210 ) ( 9dfdeed ) appserver: Compare lockfiles instead of main Gemfile ( c02af02 ) appserver: fix duplicate after_fork/on_worker_boot stanzas in appserver configs ( c0b0e84 ) worker: adapted monit config for sidekiq 6.x ( 4a58654 ), closes #215 worker: fix sidekiq quiet/shutdown scripts ( 59198b9 ), closes #217 worker: quieting and stopping sidekiq ( efc1231 ) Features \u00b6 apache: apache configuration to use appserver\u2019s port provided in custom json ( b576788 ) setup: add global option for enabling/disabling nodejs ( 1f1fa4b ) setup: support for webpacker ( 569b9bb ) setup: use latest nodejs lts 10.15.3 ( 61bb605 ) 1.14.0 (2019-03-06) \u00b6 Bug Fixes \u00b6 Ensure shared/system dir is created ( #197 ) ( 7f8cb2e ), closes /github.com/ajgon/opsworks_ruby/blob/6e2328941996d98316657d7a52c98de6982068a5/attributes/default.rb#L21 Lock the windows cookbook dependency to maintain chef 12 compatibility ( #196 ) ( a2d4a8d ) register gpg public key for nginx on ubuntu18.04LTS ( #201 ) ( 1d4705d ) apache: fix infinite redirect loop on apache, when rails force_ssl is enabled ( 3df3a16 ), closes #206 appserver: fixed Puma config compatibility with older versions of Puma ( eebdc23 ), closes #207 nginx: add missing nosniff header for SSL sessions in nginx ( e61b199 ) setup: added support for bundler 2.x and rubygems 3.x ( 7b781bd ), closes #203 webserver: Align SSL directory between template & driver ( 414298e ), closes #205 Features \u00b6 appserver: re-establish database connections when preloading app ( db17de6 ), closes #198 ruby: Added support for ruby 2.6 ( 27bad91 ) 1.13.0 (2018-11-09) \u00b6 Bug Fixes \u00b6 db: Fix typo for aurora postgresql ( 1bb2fb5 ) Features \u00b6 worker: Support Shoryuken worker library ( 5359679 ) 1.12.0 (2018-10-03) \u00b6 Features \u00b6 appserver: add port configuration ( 6540201 ) database: added aurora-postgres as an accepted engine for Postgres RDS ( 626a11d ) webserver: add support for force_ssl attribute ( 2281047 ), closes #189 1.11.0 (2018-07-17) \u00b6 Bug Fixes \u00b6 add Apache 2.4's \"Require all granted\" to apache2+passenger config file ( #171 ) ( f4e5871 ) webserver: add X-Content-Type-Options: nosniff to assets served by rails for extra security ( 07d3336 ) Features \u00b6 webserver: hardened security headers, disabled tls1.0 and tls1.1 for non-legacy SSL config ( 8351d58 ) BREAKING CHANGES \u00b6 webserver: If you are using SSL in your project, TLSv1.0 and TLSv1.1 has been disabled for all responses - only TLSv1.2 is served. If you still need older ciphers, consider using app['webserver']['ssl_for_legacy_browsers'] configuration option. 1.10.1 (2018-06-24) \u00b6 Bug Fixes \u00b6 do not read pidfile at each stop retry (prevent from early pidfile deletion) ( c5f0fe4 ), closes #163 framework: added environment variables context to bundle install ( fe01d45 ), closes #167 Features \u00b6 appserver: support rails restart command on puma. ( bb04fb4 ) db: added postgis driver ( 6b3c058 ), closes #165 1.10.0 (2018-06-10) \u00b6 Bug Fixes \u00b6 appserver: moved env files creation to before_symlink phase ( 2ed059d ), closes #157 setup: Fixed deployer user setup ( 9af3651 ), closes #159 Features \u00b6 appserver: add additional puma configuration options ( f994e2f ) ruby: introduced new ruby-version JSON parameter. ( 99798ce ), closes #156 BREAKING CHANGES \u00b6 ruby: If you were using ruby-ng.ruby_version JSON configuration parameter in your stack/layer configuration, please change it to ruby-version . Since ruby-version is set by default to the freshest version of ruby available, you may end up with unexpected upgrade of ruby on your system. 1.9.1 (2018-05-22) \u00b6 Bug Fixes \u00b6 chef: Downgraded apt cookbook below version 7 ( 8ea8eee ), closes #151 chef: Removed broken deployer cookbook ( 51a4942 ), closes #155 1.9.0 (2018-03-17) \u00b6 Bug Fixes \u00b6 appserver: Wait up to 10 sec for graceful shutdown ( def1c21 ), closes #127 configure: Don't create pids symlink if it already exists ( 4671ac9 ), closes #126 appserver: failed to start appserver. ( #146 ) ( 4505890 ) source: remove temporary directories after deploy ( b92417f ) source: Subdirectories on S3 are now properly handled ( 9373173 ) webserver: Switched chef_nginx back to nginx cookbook ( 683f840 ), closes #148 Features \u00b6 ruby: Added support for ruby 2.5 ( 2fd887a ) source: Added support for HTTP ( 34829f2 ) source: Added support for S3 ( 019c0ad ), closes #133 BREAKING CHANGES \u00b6 source: app['scm'] has been renamed to app['source'] . This only affects the Custom JSON files, so if you were using this block there, you should change it. If you were using OpsWorks git configurator (which is probably 99.99% true), this change wouldn't affect you. 1.8.0 (2017-10-23) \u00b6 Bug Fixes \u00b6 moved all pid-related files from shared/pids to /run/lock ( bc9daf0 ), closes #92 db: Respect database port provided by RDS ( #124 ) ( 7aeb78e ), closes #123 logrotate: remove duplicate log entry in config file generated from webserver service install ( eabf207 ) worker: quiet_sidekiq now uses sidekiqctl instead of kill -USR1 which is deprectaed ( 1e9e32b ), closes #93 Features \u00b6 scm: Support configurable location of git_ssh_wrapper ( #121 ) ( de153bf ), closes #120 1.7.1 (2017-09-22) \u00b6 Bug Fixes \u00b6 webserver: do not unnecessarily restart webserver ( db15b26 ), closes #114 webserver: Only remove default enabled sites ( ef085a0 ), closes #111 Features \u00b6 webserver: remove version info on Apache/Nginx ( 6aba9f3 ) 1.7.0 (2017-09-05) \u00b6 Bug Fixes \u00b6 appserver: passing USER and HOME environment variables to appserver process ( 43210bc ), closes #85 db: safer migration/setup command ( 19bf034 ), closes #58 overcommit: disable fasterer warning that was causing commits to fail ( 7752706 ) missing databag caused maximum_override integration failure ( 1be29e1 ) Features \u00b6 appserver+webserver: add apache2 + passenger support ( 43c61f9 ) database: support null database driver ( 29e1040 ), closes #98 global: support per-application deploy directory ( 28cb797 ), closes #95 logrotate: support arbitrary logrotate customization ( fa95ab0 ), closes #107 webserver: allow extensible webserver site customization ( 4efd130 ), closes #100 webserver: server_tokens off on Nginx ( #91 ) ( 5568f6c ) 1.6.0 (2017-06-03) \u00b6 Bug Fixes \u00b6 ubuntu: proper provisioning for ubuntu 16.04 ( ea5b530 ), closes #81 Features \u00b6 webserver: Specify upgrade method for nginx ( 2624d04 ) logrotate: rotate all logs in app/log ( 4737b49 ) BREAKING CHANGES \u00b6 Support for all legacy distributions has been dropped off. Currently, only Ubuntu 16.04 and Amazon Linux 2017.03 are supported. This cookbook should work on earlier versions (especially on Ubuntu), PR with fixes to them will be accepted, however the core team won't include any patches for those distros by they own. 1.5.0 (2017-04-25) \u00b6 Features \u00b6 framework: Allow increased timeout during deploy ( #76 ) ( e216972 ) logrotate: implement logrotate ( 86ebc10 ), closes #78 1.4.0 (2017-03-12) \u00b6 Bug Fixes \u00b6 Bump faraday middleware version ( d508928 ) Switched nginx cookbook to more actively developed chef_nginx ( 0f4f64c ), closes #65 Features \u00b6 webserver: Add app specific error log and location for nginx ( a098279 ) worker: Safely quiet and shutdown sidekiq ( c36652f ) BREAKING CHANGES \u00b6 nginx cookbook is not a opsworks_ruby dependency anymore. Now it's chef_nginx which is more actively developed. Please update your recipe repositories. 1.3.0 (2017-01-16) \u00b6 Features \u00b6 appserver: Allowed deploy_before_restart on null appserver ( b0375a6 ) database: Added aurora as allowed engine for mysql2 adapter ( a2789f0 ) ruby: Added support for ruby 2.4 ( a89451f ) BREAKING CHANGES \u00b6 ruby: Ruby 2.4 is now a default Ruby interpreter 1.2.1 (2016-11-27) \u00b6 Bug Fixes \u00b6 Fixed broken migration_command default ( 36cdb68 ), closes #58 1.2.0 (2016-11-02) \u00b6 Bug Fixes \u00b6 Moved global deploy parameters to app['global'] section ( b4f8d6b ) BREAKING CHANGES \u00b6 app['create_dirs_before_symlink'] , app['purge_before_symlink'] , app['rollback_on_error'] and app['symlinks'] are now app['global']['create_dirs_before_symlink'] , app['global']['purge_before_symlink'] , app['global']['rollback_on_error'] and app['global']['symlink'] . The old format still works, but it shows DEPRECATION warning. It will be removed in one of the next major releases. 1.1.2 (2016-10-27) \u00b6 Bug Fixes \u00b6 webserver: Improved apache2 support ( 4293bff ) node['applications'] are back ( 5fc42c3 ), closes #55 Features \u00b6 app['rollback_on_error'] implemented ( e6934a7 ), closes #54 1.1.1 (2016-10-21) \u00b6 Bug Fixes \u00b6 deploy: Fixed deploy callbacks launching order ( 81d31c9 ) 1.1.0 (2016-10-21) \u00b6 Bug Fixes \u00b6 Application deployment fix ( 7ac4166 ) BREAKING CHANGES \u00b6 node['applications'] becomes obsolete 1.0.0 (2016-10-04) \u00b6 Bug Fixes \u00b6 monit reload and monit restart order ( 2c4a84a ), closes #29 appserver: Removed accept_filter from unicorn configurator ( 76a7f36 ) framework: Added missing deploy_environment to null framework ( 673a21d ) framework: Fixed envs_in_console for rails ( f8856c8 ) Features \u00b6 appserver: \"Puma\" support added ( f6e80ad ), closes #38 appserver: \"Thin\" support added ( 9667939 ), closes #39 appserver: Switched default appserver from unicorn to puma ( 0e72200 ) framework: \"hanami.rb\" support added ( 23fdd04 ), closes #43 framework: \"Null\" support added ( b9e7b63 ), closes #47 framework: \"Padrino\" support added ( a240d92 ), closes #44 framework: Environemnt variables in rails console ( 89252b3 ) global: Moved app['environment'] to app['global']['environment'] ( 432a21c ), closes #50 webserver: \"Apache2\" support added ( 1ca5b0b ), closes #40 worker: \"delayed_job\" support added ( 7235720 ), closes #42 worker: \"resque\" support added ( ccc13e4 ), closes #41 Performance Improvements \u00b6 Added fasterer gem to overcommit ( c1ed974 ) BREAKING CHANGES \u00b6 global: If you were using an app['environment'] variable (for example to set env to staging), please update your stack/layer JSONs to app['global']['environment'] . appserver: Unicorn is no longer a default appserver, in favor of Puma. If you have a working instances which were relying on that, you have to either set app['appserver']['adapter'] = 'unicorn' in your stack/layer JSON file, or switch the app server in your application webserver: sites-available and sites-enabled file names format changed. From this commit, the *.conf extension is appended. If you plan to update your cookbooks on productional environments, don't forget to remove the old ones, otherwise you will end up with two the same configurations in different files, which cause nginx to fail. If you start noticing duplicate upstream errors, this is probably due this case. 0.8.0 (2016-09-02) \u00b6 Bug Fixes \u00b6 Switched from nginx reload to nginx restart after succesful deploy/undeploy ( 16ab9d1 ), closes #36 Features \u00b6 Added GIT_SSH support for bundle install ( 232e8ac ), closes #37 Caches bundler installs to speed up deployments ( baa0f44 ) Implemented configurable RAILS_ENV ( 2567b71 ), closes #34 0.7.0 (2016-08-29) \u00b6 Bug Fixes \u00b6 Moved extra env files creation, later in the stack (before_restart) ( 8a5223f ) Reload monit after restarting services ( eaa2aab ) Set the default DB adapter to sqlite3 ( b4b1ee4 ) specify bundle path on bundle install ( b9d4335 ) Features \u00b6 Added support for gems like figaro and dotenv ( c989494 ), closes #28 0.6.0 (2016-08-17) \u00b6 BREAKING CHANGES \u00b6 Removed application_ruby cookbook dependency 0.5.0 (2016-07-21) \u00b6 Features \u00b6 Added configuration for isolated worker servers w/o app/webserver ( 56642f1 ) Added monit compatibility with amazon linux ( 2ef12b9 ) 0.4.0 (2016-06-16) \u00b6 Features \u00b6 Enables drivers to be attached to before_ and after_ deploy events ( fa8e605 ) 0.3.1 (2016-06-16) \u00b6 Bug Fixes \u00b6 Change path to 500.html to be in the \"current\" dir ( 4aeac7f ) Support for multiple RDSes with multiple applications ( a23df47 ) 0.3.0 (2016-06-08) \u00b6 Features \u00b6 eliminate RDS requirement ( daa4254 ) BREAKING CHANGES \u00b6 Sqlite3 is no longer set as the default database adapter. In order to use sqlite as the database adapter it must be defined in the node. 0.2.1 (2016-05-11) \u00b6 Added environment variables support for assets precompile ( f24e742 ) Added optional removal of scm files ( 82b25ec ) Added support for custom configuration in nginx ( 448019a ) Fixed deploy environment ( bf843aa ) Fixed nginx defaults order ( af560db ) Fixed sidekiq config builder ( a32b410 ) 0.2.0 (2016-04-24) \u00b6 Added MariaDB Driver support ( 197b7de ) Added multi-platform support ( 6118154 ) Added MySQL Driver support ( 72d4b9f ) Added Sqlite Driver support ( 3ecb321 ) Minor bugfixes, resolves #19 ( 9f8615f ), closes #19 0.1.0 (2016-04-23) \u00b6 configure recipe initial implementation ( c57f71e ) Added assets precompilation support. Resolves #12 ( b8d8ff5 ), closes #12 Added auto-start of nginx to setup phase. Resolves #15 ( fbb07dc ), closes #15 Added basic documentation ( 235519f ) Added code quality tools ( 730857f ) Added core_ext specs. Resolves #7 ( b089eb3 ), closes #7 Added DHparams and nginx version detection support. Resolves #8 and resolves #9 ( 4e60594 ), closes #8 #9 Added missing specs ( ff85e4f ) Added nginx reload after deploy. Resolves #13 ( f1bc277 ), closes #13 Added ruby and bundler installation to setup phase ( 0182e70 ), closes #5 #6 Added symlinking defaults. Resolves #16 ( 4a1edd9 ), closes #16 Added travis config and coveralls support ( a782a64 ) Added undeploy recipe ( aba311b ) Added webserver setup (nginx) ( 1581def ) Added workers support. Resolves #18 ( 05e3a75 ), closes #18 Appserver implemented (unicorn) ( bbb79cc ) Basic SCM support implemented ( bcab3d7 ) Finished database support in recipes ( cf955a0 ) Fixed appserver restart sequence ( 9a75f9c ) Fixed nginx defaults. Resolves #14 and resolves #17 ( 8320f3b ), closes #14 #17 Fixes on bugs detected while deploying to real OpsWorks ( 035363b ) Initial commit ( d8bed5c ) Initial version, with simple postgresql driver introduced ( 5d00083 ) Moved DB packages installation from configure to setup ( e23f2d4 ) Moved libraries to flat directory structure, because AWS chef hates us ( e6aa211 ) Rails deploy hooks implemented ( 79d2d64 ) Recipes cleanup: added missing actions and shutdown recipe ( 9eb9bb8 ) Reorganized appserver cookbooks, added bundle install to deploy ( 2e9947b )","title":"Changelog"},{"location":"changelog/#1230-2022-06-30","text":"","title":"1.23.0 (2022-06-30)"},{"location":"changelog/#features","text":"worker: worker option to use dot env ( #289 ) ( ba3d312 )","title":"Features"},{"location":"changelog/#1220-2022-02-09","text":"","title":"1.22.0 (2022-02-09)"},{"location":"changelog/#bug-fixes","text":"appserver: use pumactl start for restart if the puma.state file does not exists ( #276 ) ( c2c8713 ), closes #274","title":"Bug Fixes"},{"location":"changelog/#features_1","text":"worker: add good_job support ( af98d67 )","title":"Features"},{"location":"changelog/#1211-2021-10-13","text":"","title":"1.21.1 (2021-10-13)"},{"location":"changelog/#bug-fixes_1","text":"modify the restart process for puma so that it can do a proper restart instead of killing and restarting the app ( #257 ) ( 035ffb9 )","title":"Bug Fixes"},{"location":"changelog/#1210-2021-10-08","text":"","title":"1.21.0 (2021-10-08)"},{"location":"changelog/#bug-fixes_2","text":"patch broken SSL certificates list ( 4887cf5 ), closes #268 update rubies for ruby-nq and fullstack, set default ruby to 2.7 ( 09ba7e1 ), closes #266","title":"Bug Fixes"},{"location":"changelog/#breaking-changes","text":"By default new list of SSL certificates is used. It should not affect any of your current deployments, but if you start seeing SSL errors, the first thing you should check, is disabling node['patches']['chef12_ssl_fix'] option. See https://github.com/ajgon/opsworks_ruby/issues/268 for more information.","title":"BREAKING CHANGES"},{"location":"changelog/#1203-2021-05-06","text":"","title":"1.20.3 (2021-05-06)"},{"location":"changelog/#features_2","text":"webserver: apache2 - configurable mod_status ( a82335d ), closes #259","title":"Features"},{"location":"changelog/#1202-2021-02-07","text":"","title":"1.20.2 (2021-02-07)"},{"location":"changelog/#bug-fixes_3","text":"run monit reload only once, after configure hook ( 1b784d1 ), closes #251","title":"Bug Fixes"},{"location":"changelog/#1201-2020-12-12","text":"","title":"1.20.1 (2020-12-12)"},{"location":"changelog/#features_3","text":"webserver: add CORS for /packs endpoints ( ede019d ), closes #248","title":"Features"},{"location":"changelog/#1200-2020-12-08","text":"","title":"1.20.0 (2020-12-08)"},{"location":"changelog/#bug-fixes_4","text":"setup: fix fullstaq key url ( #247 ) ( 62ced10 )","title":"Bug Fixes"},{"location":"changelog/#features_4","text":"appserver: move appserver processes to foreground ( 37b9465 ), closes #244 deploy: use revision-based deploy provider ( #245 ) ( 27887e6 )","title":"Features"},{"location":"changelog/#breaking-changes_1","text":"appserver: Theoretically everything should work out of the box, and you shouldn't notice any change on your environment. However if your appserver start behave oddly (or probably - won't start at all) - this may be the first reason for that. Check generated monit files, check if monit is running and also check the syslog (monit is configured to write all the appserver output there).","title":"BREAKING CHANGES"},{"location":"changelog/#1190-2020-08-02","text":"","title":"1.19.0 (2020-08-02)"},{"location":"changelog/#features_5","text":"deploy: include deploy resource polyfill ( 4f6d6fd ), closes #242","title":"Features"},{"location":"changelog/#1181-2020-05-13","text":"","title":"1.18.1 (2020-05-13)"},{"location":"changelog/#bug-fixes_5","text":"setup: link fullstaq ruby to /usr/local/bin ( 559c015 ), closes #237","title":"Bug Fixes"},{"location":"changelog/#1180-2020-02-29","text":"","title":"1.18.0 (2020-02-29)"},{"location":"changelog/#bug-fixes_6","text":"appserver: fix .env and application.yml symlinks creation ( 0580955 ), closes #232","title":"Bug Fixes"},{"location":"changelog/#features_6","text":"appserver: Add new appserver config params for passenger ( #227 ) ( 0500521 ) setup: add support for fullstaq ruby repos ( 1489d01 ), closes #229","title":"Features"},{"location":"changelog/#1170-2019-11-23","text":"","title":"1.17.0 (2019-11-23)"},{"location":"changelog/#bug-fixes_7","text":"replace symlink options instead of appending them ( b2650fb ), closes #224","title":"Bug Fixes"},{"location":"changelog/#features_7","text":"database: add support for multiple databases per environment ( 0c7f89f ), closes #226","title":"Features"},{"location":"changelog/#breaking-changes_2","text":"app['global']['create_dirs_before_symlink'] , app['global']['purge_before_symlink'] and app['global']['symlinks'] now overrides defaults instead of appending them. If you were relying on those options in your Custom JSON, you need to add missing defaults manually. For example given: { \"deploy\": { \"myapp\": { \"global\": { \"create_dirs_before_symlink\": [\"test/create\"], \"purge_before_symlink\": [\"test/purge\"], \"symlinks\": { \"test\": \"test/symlinks\" } } } } } you need to replace it to: { \"deploy\": { \"myapp\": { \"global\": { \"create_dirs_before_symlink\": [\"tmp\", \"public\", \"config\", \"../../shared/cache\", \"../../shared/assets\", \"test/create\"], \"purge_before_symlink\": [\"log\", \"tmp/cache\", \"tmp/pids\", \"public/system\", \"public/assets\", \"test/purge\"], \"symlinks\": { \"system\": \"public/system\", \"assets\": \"public/assets\", \"cache\": \"tmp/cache\", \"pids\": \"tmp/pids\", \"log\": \"log\", \"test\": \"test/symlinks\" } } } } }","title":"BREAKING CHANGES"},{"location":"changelog/#1160-2019-09-11","text":"","title":"1.16.0 (2019-09-11)"},{"location":"changelog/#bug-fixes_8","text":"webserver: remove default nginx config from conf.d ( #220 ) ( 23929e3 ) keep the last nginx cookbook version compatible with chef 12 ( b5b13d0 ), closes #222","title":"Bug Fixes"},{"location":"changelog/#features_8","text":"setup: add chef version configuration option ( ffe2b42 )","title":"Features"},{"location":"changelog/#1150-2019-07-09","text":"","title":"1.15.0 (2019-07-09)"},{"location":"changelog/#bug-fixes_9","text":"apache: fix apache serving assets rather than proxying to app server ( #210 ) ( 9dfdeed ) appserver: Compare lockfiles instead of main Gemfile ( c02af02 ) appserver: fix duplicate after_fork/on_worker_boot stanzas in appserver configs ( c0b0e84 ) worker: adapted monit config for sidekiq 6.x ( 4a58654 ), closes #215 worker: fix sidekiq quiet/shutdown scripts ( 59198b9 ), closes #217 worker: quieting and stopping sidekiq ( efc1231 )","title":"Bug Fixes"},{"location":"changelog/#features_9","text":"apache: apache configuration to use appserver\u2019s port provided in custom json ( b576788 ) setup: add global option for enabling/disabling nodejs ( 1f1fa4b ) setup: support for webpacker ( 569b9bb ) setup: use latest nodejs lts 10.15.3 ( 61bb605 )","title":"Features"},{"location":"changelog/#1140-2019-03-06","text":"","title":"1.14.0 (2019-03-06)"},{"location":"changelog/#bug-fixes_10","text":"Ensure shared/system dir is created ( #197 ) ( 7f8cb2e ), closes /github.com/ajgon/opsworks_ruby/blob/6e2328941996d98316657d7a52c98de6982068a5/attributes/default.rb#L21 Lock the windows cookbook dependency to maintain chef 12 compatibility ( #196 ) ( a2d4a8d ) register gpg public key for nginx on ubuntu18.04LTS ( #201 ) ( 1d4705d ) apache: fix infinite redirect loop on apache, when rails force_ssl is enabled ( 3df3a16 ), closes #206 appserver: fixed Puma config compatibility with older versions of Puma ( eebdc23 ), closes #207 nginx: add missing nosniff header for SSL sessions in nginx ( e61b199 ) setup: added support for bundler 2.x and rubygems 3.x ( 7b781bd ), closes #203 webserver: Align SSL directory between template & driver ( 414298e ), closes #205","title":"Bug Fixes"},{"location":"changelog/#features_10","text":"appserver: re-establish database connections when preloading app ( db17de6 ), closes #198 ruby: Added support for ruby 2.6 ( 27bad91 )","title":"Features"},{"location":"changelog/#1130-2018-11-09","text":"","title":"1.13.0 (2018-11-09)"},{"location":"changelog/#bug-fixes_11","text":"db: Fix typo for aurora postgresql ( 1bb2fb5 )","title":"Bug Fixes"},{"location":"changelog/#features_11","text":"worker: Support Shoryuken worker library ( 5359679 )","title":"Features"},{"location":"changelog/#1120-2018-10-03","text":"","title":"1.12.0 (2018-10-03)"},{"location":"changelog/#features_12","text":"appserver: add port configuration ( 6540201 ) database: added aurora-postgres as an accepted engine for Postgres RDS ( 626a11d ) webserver: add support for force_ssl attribute ( 2281047 ), closes #189","title":"Features"},{"location":"changelog/#1110-2018-07-17","text":"","title":"1.11.0 (2018-07-17)"},{"location":"changelog/#bug-fixes_12","text":"add Apache 2.4's \"Require all granted\" to apache2+passenger config file ( #171 ) ( f4e5871 ) webserver: add X-Content-Type-Options: nosniff to assets served by rails for extra security ( 07d3336 )","title":"Bug Fixes"},{"location":"changelog/#features_13","text":"webserver: hardened security headers, disabled tls1.0 and tls1.1 for non-legacy SSL config ( 8351d58 )","title":"Features"},{"location":"changelog/#breaking-changes_3","text":"webserver: If you are using SSL in your project, TLSv1.0 and TLSv1.1 has been disabled for all responses - only TLSv1.2 is served. If you still need older ciphers, consider using app['webserver']['ssl_for_legacy_browsers'] configuration option.","title":"BREAKING CHANGES"},{"location":"changelog/#1101-2018-06-24","text":"","title":"1.10.1 (2018-06-24)"},{"location":"changelog/#bug-fixes_13","text":"do not read pidfile at each stop retry (prevent from early pidfile deletion) ( c5f0fe4 ), closes #163 framework: added environment variables context to bundle install ( fe01d45 ), closes #167","title":"Bug Fixes"},{"location":"changelog/#features_14","text":"appserver: support rails restart command on puma. ( bb04fb4 ) db: added postgis driver ( 6b3c058 ), closes #165","title":"Features"},{"location":"changelog/#1100-2018-06-10","text":"","title":"1.10.0 (2018-06-10)"},{"location":"changelog/#bug-fixes_14","text":"appserver: moved env files creation to before_symlink phase ( 2ed059d ), closes #157 setup: Fixed deployer user setup ( 9af3651 ), closes #159","title":"Bug Fixes"},{"location":"changelog/#features_15","text":"appserver: add additional puma configuration options ( f994e2f ) ruby: introduced new ruby-version JSON parameter. ( 99798ce ), closes #156","title":"Features"},{"location":"changelog/#breaking-changes_4","text":"ruby: If you were using ruby-ng.ruby_version JSON configuration parameter in your stack/layer configuration, please change it to ruby-version . Since ruby-version is set by default to the freshest version of ruby available, you may end up with unexpected upgrade of ruby on your system.","title":"BREAKING CHANGES"},{"location":"changelog/#191-2018-05-22","text":"","title":"1.9.1 (2018-05-22)"},{"location":"changelog/#bug-fixes_15","text":"chef: Downgraded apt cookbook below version 7 ( 8ea8eee ), closes #151 chef: Removed broken deployer cookbook ( 51a4942 ), closes #155","title":"Bug Fixes"},{"location":"changelog/#190-2018-03-17","text":"","title":"1.9.0 (2018-03-17)"},{"location":"changelog/#bug-fixes_16","text":"appserver: Wait up to 10 sec for graceful shutdown ( def1c21 ), closes #127 configure: Don't create pids symlink if it already exists ( 4671ac9 ), closes #126 appserver: failed to start appserver. ( #146 ) ( 4505890 ) source: remove temporary directories after deploy ( b92417f ) source: Subdirectories on S3 are now properly handled ( 9373173 ) webserver: Switched chef_nginx back to nginx cookbook ( 683f840 ), closes #148","title":"Bug Fixes"},{"location":"changelog/#features_16","text":"ruby: Added support for ruby 2.5 ( 2fd887a ) source: Added support for HTTP ( 34829f2 ) source: Added support for S3 ( 019c0ad ), closes #133","title":"Features"},{"location":"changelog/#breaking-changes_5","text":"source: app['scm'] has been renamed to app['source'] . This only affects the Custom JSON files, so if you were using this block there, you should change it. If you were using OpsWorks git configurator (which is probably 99.99% true), this change wouldn't affect you.","title":"BREAKING CHANGES"},{"location":"changelog/#180-2017-10-23","text":"","title":"1.8.0 (2017-10-23)"},{"location":"changelog/#bug-fixes_17","text":"moved all pid-related files from shared/pids to /run/lock ( bc9daf0 ), closes #92 db: Respect database port provided by RDS ( #124 ) ( 7aeb78e ), closes #123 logrotate: remove duplicate log entry in config file generated from webserver service install ( eabf207 ) worker: quiet_sidekiq now uses sidekiqctl instead of kill -USR1 which is deprectaed ( 1e9e32b ), closes #93","title":"Bug Fixes"},{"location":"changelog/#features_17","text":"scm: Support configurable location of git_ssh_wrapper ( #121 ) ( de153bf ), closes #120","title":"Features"},{"location":"changelog/#171-2017-09-22","text":"","title":"1.7.1 (2017-09-22)"},{"location":"changelog/#bug-fixes_18","text":"webserver: do not unnecessarily restart webserver ( db15b26 ), closes #114 webserver: Only remove default enabled sites ( ef085a0 ), closes #111","title":"Bug Fixes"},{"location":"changelog/#features_18","text":"webserver: remove version info on Apache/Nginx ( 6aba9f3 )","title":"Features"},{"location":"changelog/#170-2017-09-05","text":"","title":"1.7.0 (2017-09-05)"},{"location":"changelog/#bug-fixes_19","text":"appserver: passing USER and HOME environment variables to appserver process ( 43210bc ), closes #85 db: safer migration/setup command ( 19bf034 ), closes #58 overcommit: disable fasterer warning that was causing commits to fail ( 7752706 ) missing databag caused maximum_override integration failure ( 1be29e1 )","title":"Bug Fixes"},{"location":"changelog/#features_19","text":"appserver+webserver: add apache2 + passenger support ( 43c61f9 ) database: support null database driver ( 29e1040 ), closes #98 global: support per-application deploy directory ( 28cb797 ), closes #95 logrotate: support arbitrary logrotate customization ( fa95ab0 ), closes #107 webserver: allow extensible webserver site customization ( 4efd130 ), closes #100 webserver: server_tokens off on Nginx ( #91 ) ( 5568f6c )","title":"Features"},{"location":"changelog/#160-2017-06-03","text":"","title":"1.6.0 (2017-06-03)"},{"location":"changelog/#bug-fixes_20","text":"ubuntu: proper provisioning for ubuntu 16.04 ( ea5b530 ), closes #81","title":"Bug Fixes"},{"location":"changelog/#features_20","text":"webserver: Specify upgrade method for nginx ( 2624d04 ) logrotate: rotate all logs in app/log ( 4737b49 )","title":"Features"},{"location":"changelog/#breaking-changes_6","text":"Support for all legacy distributions has been dropped off. Currently, only Ubuntu 16.04 and Amazon Linux 2017.03 are supported. This cookbook should work on earlier versions (especially on Ubuntu), PR with fixes to them will be accepted, however the core team won't include any patches for those distros by they own.","title":"BREAKING CHANGES"},{"location":"changelog/#150-2017-04-25","text":"","title":"1.5.0 (2017-04-25)"},{"location":"changelog/#features_21","text":"framework: Allow increased timeout during deploy ( #76 ) ( e216972 ) logrotate: implement logrotate ( 86ebc10 ), closes #78","title":"Features"},{"location":"changelog/#140-2017-03-12","text":"","title":"1.4.0 (2017-03-12)"},{"location":"changelog/#bug-fixes_21","text":"Bump faraday middleware version ( d508928 ) Switched nginx cookbook to more actively developed chef_nginx ( 0f4f64c ), closes #65","title":"Bug Fixes"},{"location":"changelog/#features_22","text":"webserver: Add app specific error log and location for nginx ( a098279 ) worker: Safely quiet and shutdown sidekiq ( c36652f )","title":"Features"},{"location":"changelog/#breaking-changes_7","text":"nginx cookbook is not a opsworks_ruby dependency anymore. Now it's chef_nginx which is more actively developed. Please update your recipe repositories.","title":"BREAKING CHANGES"},{"location":"changelog/#130-2017-01-16","text":"","title":"1.3.0 (2017-01-16)"},{"location":"changelog/#features_23","text":"appserver: Allowed deploy_before_restart on null appserver ( b0375a6 ) database: Added aurora as allowed engine for mysql2 adapter ( a2789f0 ) ruby: Added support for ruby 2.4 ( a89451f )","title":"Features"},{"location":"changelog/#breaking-changes_8","text":"ruby: Ruby 2.4 is now a default Ruby interpreter","title":"BREAKING CHANGES"},{"location":"changelog/#121-2016-11-27","text":"","title":"1.2.1 (2016-11-27)"},{"location":"changelog/#bug-fixes_22","text":"Fixed broken migration_command default ( 36cdb68 ), closes #58","title":"Bug Fixes"},{"location":"changelog/#120-2016-11-02","text":"","title":"1.2.0 (2016-11-02)"},{"location":"changelog/#bug-fixes_23","text":"Moved global deploy parameters to app['global'] section ( b4f8d6b )","title":"Bug Fixes"},{"location":"changelog/#breaking-changes_9","text":"app['create_dirs_before_symlink'] , app['purge_before_symlink'] , app['rollback_on_error'] and app['symlinks'] are now app['global']['create_dirs_before_symlink'] , app['global']['purge_before_symlink'] , app['global']['rollback_on_error'] and app['global']['symlink'] . The old format still works, but it shows DEPRECATION warning. It will be removed in one of the next major releases.","title":"BREAKING CHANGES"},{"location":"changelog/#112-2016-10-27","text":"","title":"1.1.2 (2016-10-27)"},{"location":"changelog/#bug-fixes_24","text":"webserver: Improved apache2 support ( 4293bff ) node['applications'] are back ( 5fc42c3 ), closes #55","title":"Bug Fixes"},{"location":"changelog/#features_24","text":"app['rollback_on_error'] implemented ( e6934a7 ), closes #54","title":"Features"},{"location":"changelog/#111-2016-10-21","text":"","title":"1.1.1 (2016-10-21)"},{"location":"changelog/#bug-fixes_25","text":"deploy: Fixed deploy callbacks launching order ( 81d31c9 )","title":"Bug Fixes"},{"location":"changelog/#110-2016-10-21","text":"","title":"1.1.0 (2016-10-21)"},{"location":"changelog/#bug-fixes_26","text":"Application deployment fix ( 7ac4166 )","title":"Bug Fixes"},{"location":"changelog/#breaking-changes_10","text":"node['applications'] becomes obsolete","title":"BREAKING CHANGES"},{"location":"changelog/#100-2016-10-04","text":"","title":"1.0.0 (2016-10-04)"},{"location":"changelog/#bug-fixes_27","text":"monit reload and monit restart order ( 2c4a84a ), closes #29 appserver: Removed accept_filter from unicorn configurator ( 76a7f36 ) framework: Added missing deploy_environment to null framework ( 673a21d ) framework: Fixed envs_in_console for rails ( f8856c8 )","title":"Bug Fixes"},{"location":"changelog/#features_25","text":"appserver: \"Puma\" support added ( f6e80ad ), closes #38 appserver: \"Thin\" support added ( 9667939 ), closes #39 appserver: Switched default appserver from unicorn to puma ( 0e72200 ) framework: \"hanami.rb\" support added ( 23fdd04 ), closes #43 framework: \"Null\" support added ( b9e7b63 ), closes #47 framework: \"Padrino\" support added ( a240d92 ), closes #44 framework: Environemnt variables in rails console ( 89252b3 ) global: Moved app['environment'] to app['global']['environment'] ( 432a21c ), closes #50 webserver: \"Apache2\" support added ( 1ca5b0b ), closes #40 worker: \"delayed_job\" support added ( 7235720 ), closes #42 worker: \"resque\" support added ( ccc13e4 ), closes #41","title":"Features"},{"location":"changelog/#performance-improvements","text":"Added fasterer gem to overcommit ( c1ed974 )","title":"Performance Improvements"},{"location":"changelog/#breaking-changes_11","text":"global: If you were using an app['environment'] variable (for example to set env to staging), please update your stack/layer JSONs to app['global']['environment'] . appserver: Unicorn is no longer a default appserver, in favor of Puma. If you have a working instances which were relying on that, you have to either set app['appserver']['adapter'] = 'unicorn' in your stack/layer JSON file, or switch the app server in your application webserver: sites-available and sites-enabled file names format changed. From this commit, the *.conf extension is appended. If you plan to update your cookbooks on productional environments, don't forget to remove the old ones, otherwise you will end up with two the same configurations in different files, which cause nginx to fail. If you start noticing duplicate upstream errors, this is probably due this case.","title":"BREAKING CHANGES"},{"location":"changelog/#080-2016-09-02","text":"","title":"0.8.0 (2016-09-02)"},{"location":"changelog/#bug-fixes_28","text":"Switched from nginx reload to nginx restart after succesful deploy/undeploy ( 16ab9d1 ), closes #36","title":"Bug Fixes"},{"location":"changelog/#features_26","text":"Added GIT_SSH support for bundle install ( 232e8ac ), closes #37 Caches bundler installs to speed up deployments ( baa0f44 ) Implemented configurable RAILS_ENV ( 2567b71 ), closes #34","title":"Features"},{"location":"changelog/#070-2016-08-29","text":"","title":"0.7.0 (2016-08-29)"},{"location":"changelog/#bug-fixes_29","text":"Moved extra env files creation, later in the stack (before_restart) ( 8a5223f ) Reload monit after restarting services ( eaa2aab ) Set the default DB adapter to sqlite3 ( b4b1ee4 ) specify bundle path on bundle install ( b9d4335 )","title":"Bug Fixes"},{"location":"changelog/#features_27","text":"Added support for gems like figaro and dotenv ( c989494 ), closes #28","title":"Features"},{"location":"changelog/#060-2016-08-17","text":"","title":"0.6.0 (2016-08-17)"},{"location":"changelog/#breaking-changes_12","text":"Removed application_ruby cookbook dependency","title":"BREAKING CHANGES"},{"location":"changelog/#050-2016-07-21","text":"","title":"0.5.0 (2016-07-21)"},{"location":"changelog/#features_28","text":"Added configuration for isolated worker servers w/o app/webserver ( 56642f1 ) Added monit compatibility with amazon linux ( 2ef12b9 )","title":"Features"},{"location":"changelog/#040-2016-06-16","text":"","title":"0.4.0 (2016-06-16)"},{"location":"changelog/#features_29","text":"Enables drivers to be attached to before_ and after_ deploy events ( fa8e605 )","title":"Features"},{"location":"changelog/#031-2016-06-16","text":"","title":"0.3.1 (2016-06-16)"},{"location":"changelog/#bug-fixes_30","text":"Change path to 500.html to be in the \"current\" dir ( 4aeac7f ) Support for multiple RDSes with multiple applications ( a23df47 )","title":"Bug Fixes"},{"location":"changelog/#030-2016-06-08","text":"","title":"0.3.0 (2016-06-08)"},{"location":"changelog/#features_30","text":"eliminate RDS requirement ( daa4254 )","title":"Features"},{"location":"changelog/#breaking-changes_13","text":"Sqlite3 is no longer set as the default database adapter. In order to use sqlite as the database adapter it must be defined in the node.","title":"BREAKING CHANGES"},{"location":"changelog/#021-2016-05-11","text":"Added environment variables support for assets precompile ( f24e742 ) Added optional removal of scm files ( 82b25ec ) Added support for custom configuration in nginx ( 448019a ) Fixed deploy environment ( bf843aa ) Fixed nginx defaults order ( af560db ) Fixed sidekiq config builder ( a32b410 )","title":"0.2.1 (2016-05-11)"},{"location":"changelog/#020-2016-04-24","text":"Added MariaDB Driver support ( 197b7de ) Added multi-platform support ( 6118154 ) Added MySQL Driver support ( 72d4b9f ) Added Sqlite Driver support ( 3ecb321 ) Minor bugfixes, resolves #19 ( 9f8615f ), closes #19","title":"0.2.0 (2016-04-24)"},{"location":"changelog/#010-2016-04-23","text":"configure recipe initial implementation ( c57f71e ) Added assets precompilation support. Resolves #12 ( b8d8ff5 ), closes #12 Added auto-start of nginx to setup phase. Resolves #15 ( fbb07dc ), closes #15 Added basic documentation ( 235519f ) Added code quality tools ( 730857f ) Added core_ext specs. Resolves #7 ( b089eb3 ), closes #7 Added DHparams and nginx version detection support. Resolves #8 and resolves #9 ( 4e60594 ), closes #8 #9 Added missing specs ( ff85e4f ) Added nginx reload after deploy. Resolves #13 ( f1bc277 ), closes #13 Added ruby and bundler installation to setup phase ( 0182e70 ), closes #5 #6 Added symlinking defaults. Resolves #16 ( 4a1edd9 ), closes #16 Added travis config and coveralls support ( a782a64 ) Added undeploy recipe ( aba311b ) Added webserver setup (nginx) ( 1581def ) Added workers support. Resolves #18 ( 05e3a75 ), closes #18 Appserver implemented (unicorn) ( bbb79cc ) Basic SCM support implemented ( bcab3d7 ) Finished database support in recipes ( cf955a0 ) Fixed appserver restart sequence ( 9a75f9c ) Fixed nginx defaults. Resolves #14 and resolves #17 ( 8320f3b ), closes #14 #17 Fixes on bugs detected while deploying to real OpsWorks ( 035363b ) Initial commit ( d8bed5c ) Initial version, with simple postgresql driver introduced ( 5d00083 ) Moved DB packages installation from configure to setup ( e23f2d4 ) Moved libraries to flat directory structure, because AWS chef hates us ( e6aa211 ) Rails deploy hooks implemented ( 79d2d64 ) Recipes cleanup: added missing actions and shutdown recipe ( 9eb9bb8 ) Reorganized appserver cookbooks, added bundle install to deploy ( 2e9947b )","title":"0.1.0 (2016-04-23)"},{"location":"contributing/","text":"Contributing \u00b6 Contributions are welcome and will be fully credited . We accept contributions via Pull Requests on Github . Pull Requests \u00b6 Lint your code - The easiest way to apply the conventions is to install overcommit . Add tests! - Your patch won't be accepted if it doesn't have tests. Document any change in behaviour - Make sure the README and any other relevant documentation are kept up-to-date. Consider our release cycle - We try to follow semver . Randomly breaking public APIs is not an option. Create topic branches - Don't ask us to pull from your master branch. One pull request per feature - If you want to do more than one thing, send multiple pull requests. Send coherent history - Make sure each individual commit in your pull request is meaningful. If you had to make multiple intermediate commits while developing, please squash them before submitting. Commit convention - We follow AngularJS Git Commit Message Conventions Running Tests \u00b6 Ensure, that you have Chef DK installed. bundle exec overcommit -r chef exec rspec Happy coding!","title":"Contributing"},{"location":"contributing/#contributing","text":"Contributions are welcome and will be fully credited . We accept contributions via Pull Requests on Github .","title":"Contributing"},{"location":"contributing/#pull-requests","text":"Lint your code - The easiest way to apply the conventions is to install overcommit . Add tests! - Your patch won't be accepted if it doesn't have tests. Document any change in behaviour - Make sure the README and any other relevant documentation are kept up-to-date. Consider our release cycle - We try to follow semver . Randomly breaking public APIs is not an option. Create topic branches - Don't ask us to pull from your master branch. One pull request per feature - If you want to do more than one thing, send multiple pull requests. Send coherent history - Make sure each individual commit in your pull request is meaningful. If you had to make multiple intermediate commits while developing, please squash them before submitting. Commit convention - We follow AngularJS Git Commit Message Conventions","title":"Pull Requests"},{"location":"contributing/#running-tests","text":"Ensure, that you have Chef DK installed. bundle exec overcommit -r chef exec rspec Happy coding!","title":"Running Tests"},{"location":"getting-started/","text":"Getting Started \u00b6 Super Quick Start \u00b6 This cookbook is designed to \"just work\". So in base case scenario, all you have to do is create a layer and application with an optional assigned RDS data source, then add Recipes to the corresponding OpsWorks actions. The base scenario includes nginx as a web server, puma as application server, Ruby on Rails as framework, and no extra workers (sidekiq/resque/etc.). If this okay for you, and if you configured RDS and application properly from OpsWorks panel - you don't have to do anything else with those recipes. Quick Start \u00b6 Alternativelly, you can use a JSON configurator , which is a nice tool which would help you quickly generate Stack/Layer JSON (and hassle free). It supports, all the configuration parameters in most of the cases. If you wish to configure multiple apps, use the generator for each one of them separately. Full configuration \u00b6 You can always create your JSON file manually, just head to the Attributes section of this documentation, and check which one you need.","title":"Getting Started"},{"location":"getting-started/#getting-started","text":"","title":"Getting Started"},{"location":"getting-started/#super-quick-start","text":"This cookbook is designed to \"just work\". So in base case scenario, all you have to do is create a layer and application with an optional assigned RDS data source, then add Recipes to the corresponding OpsWorks actions. The base scenario includes nginx as a web server, puma as application server, Ruby on Rails as framework, and no extra workers (sidekiq/resque/etc.). If this okay for you, and if you configured RDS and application properly from OpsWorks panel - you don't have to do anything else with those recipes.","title":"Super Quick Start"},{"location":"getting-started/#quick-start","text":"Alternativelly, you can use a JSON configurator , which is a nice tool which would help you quickly generate Stack/Layer JSON (and hassle free). It supports, all the configuration parameters in most of the cases. If you wish to configure multiple apps, use the generator for each one of them separately.","title":"Quick Start"},{"location":"getting-started/#full-configuration","text":"You can always create your JSON file manually, just head to the Attributes section of this documentation, and check which one you need.","title":"Full configuration"},{"location":"license/","text":"License The MIT License (MIT) Copyright (c) 2016-2021 Igor Rzegocki Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.","title":"License"},{"location":"recipes/","text":"Recipes \u00b6 This cookbook provides five main recipes, which should be attached to corresponding OpsWorks actions. opsworks_ruby::setup - attach to Setup opsworks_ruby::configure - attach to Configure opsworks_ruby::deploy - attach to Deploy opsworks_ruby::undeploy - attach to Undeploy opsworks_ruby::shutdown - attach to Shutdown","title":"Recipes"},{"location":"recipes/#recipes","text":"This cookbook provides five main recipes, which should be attached to corresponding OpsWorks actions. opsworks_ruby::setup - attach to Setup opsworks_ruby::configure - attach to Configure opsworks_ruby::deploy - attach to Deploy opsworks_ruby::undeploy - attach to Undeploy opsworks_ruby::shutdown - attach to Shutdown","title":"Recipes"},{"location":"requirements/","text":"Requirements \u00b6 Cookbooks \u00b6 ruby-ng nginx Platform \u00b6 This cookbook was tested on the following OpsWorks platforms: Amazon Linux 2017.03 Ubuntu 16.04 LTS In addition, all recent Debian family distrubutions are assumed to work.","title":"Requirements"},{"location":"requirements/#requirements","text":"","title":"Requirements"},{"location":"requirements/#cookbooks","text":"ruby-ng nginx","title":"Cookbooks"},{"location":"requirements/#platform","text":"This cookbook was tested on the following OpsWorks platforms: Amazon Linux 2017.03 Ubuntu 16.04 LTS In addition, all recent Debian family distrubutions are assumed to work.","title":"Platform"},{"location":"support/","text":"Supported Technologies \u00b6 Database MariaDB MySQL PostgreSQL Sqlite3 Sources Amazon S3 Git Framework Null (no framework) hanami.rb Padrino Ruby on Rails App server Null (no appserver) Puma Thin Unicorn Web server Null (no webserver) Apache2 nginx Worker Null (no worker) delayed_job resque sidekiq shoryuken good_job","title":"Supported Technologies"},{"location":"support/#supported-technologies","text":"Database MariaDB MySQL PostgreSQL Sqlite3 Sources Amazon S3 Git Framework Null (no framework) hanami.rb Padrino Ruby on Rails App server Null (no appserver) Puma Thin Unicorn Web server Null (no webserver) Apache2 nginx Worker Null (no worker) delayed_job resque sidekiq shoryuken good_job","title":"Supported Technologies"},{"location":"team/","text":"Author and Contributors \u00b6 Author \u00b6 Igor Rzegocki ( @ajgon ) Contributors \u00b6 Nick Marden ( @nickmarden ) Phong Si ( @phongsi ) Kevin Olbrich ( @olbrich ) Kevin Pheasey ( @kpheasey ) Nathan Flood ( @npflood ) Teruo Adachi ( @interu ) Marcos Beirigo ( @marcosbeirigo ) John Calvin Young ( @johncalvinyoung ) Rich Seviora ( @richseviora ) Kazuki Fujii ( @kazukifujii ) Kazuki Nishikawa ( @kzkn ) Josh Burks ( @dotnofoolin )","title":"Author and Contributors"},{"location":"team/#author-and-contributors","text":"","title":"Author and Contributors"},{"location":"team/#author","text":"Igor Rzegocki ( @ajgon )","title":"Author"},{"location":"team/#contributors","text":"Nick Marden ( @nickmarden ) Phong Si ( @phongsi ) Kevin Olbrich ( @olbrich ) Kevin Pheasey ( @kpheasey ) Nathan Flood ( @npflood ) Teruo Adachi ( @interu ) Marcos Beirigo ( @marcosbeirigo ) John Calvin Young ( @johncalvinyoung ) Rich Seviora ( @richseviora ) Kazuki Fujii ( @kazukifujii ) Kazuki Nishikawa ( @kzkn ) Josh Burks ( @dotnofoolin )","title":"Contributors"},{"location":"troubleshooting/","text":"Troubleshooting \u00b6 Deployment fails with errors regarding application code \u00b6 If you have enabled app['framework']['envs_in_console'] parameter, always disable it first and check if error occurs again. This parameter is a \"hack\" on rails config/application.rb file, which inserts all application environment variables before initializing the Rails stack. This may cause some problems (in very rare cases), and break this file. SSL not working in legacy browsers \u00b6 By default webserver is configured to follow strict SSL security standards, covered in this article . However, old browsers (like IE < 9 or Android < 2.2) wouldn't work with this configuration very well. If your application needs a support for those browsers, set app['webserver']['ssl_for_legacy_browsers'] to true. Some applications on my Layer deploys, some of them not \u00b6 Check the node['applications'] parameter in Attributes section. If set, it narrows down the list of applications allowed to deploy, to its value. If not sure what to do - try to remove from your Stack/Layer config and see if this helps. Environment variables fail to update on clean restart \u00b6 If you changed after_deploy method in your appserver, to do a clean restart , please not that ENV variables, are not refreshed from applicatino perspective. More details are covered in Issue #142 .","title":"Troubleshooting"},{"location":"troubleshooting/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"troubleshooting/#deployment-fails-with-errors-regarding-application-code","text":"If you have enabled app['framework']['envs_in_console'] parameter, always disable it first and check if error occurs again. This parameter is a \"hack\" on rails config/application.rb file, which inserts all application environment variables before initializing the Rails stack. This may cause some problems (in very rare cases), and break this file.","title":"Deployment fails with errors regarding application code"},{"location":"troubleshooting/#ssl-not-working-in-legacy-browsers","text":"By default webserver is configured to follow strict SSL security standards, covered in this article . However, old browsers (like IE < 9 or Android < 2.2) wouldn't work with this configuration very well. If your application needs a support for those browsers, set app['webserver']['ssl_for_legacy_browsers'] to true.","title":"SSL not working in legacy browsers"},{"location":"troubleshooting/#some-applications-on-my-layer-deploys-some-of-them-not","text":"Check the node['applications'] parameter in Attributes section. If set, it narrows down the list of applications allowed to deploy, to its value. If not sure what to do - try to remove from your Stack/Layer config and see if this helps.","title":"Some applications on my Layer deploys, some of them not"},{"location":"troubleshooting/#environment-variables-fail-to-update-on-clean-restart","text":"If you changed after_deploy method in your appserver, to do a clean restart , please not that ENV variables, are not refreshed from applicatino perspective. More details are covered in Issue #142 .","title":"Environment variables fail to update on clean restart"}]}